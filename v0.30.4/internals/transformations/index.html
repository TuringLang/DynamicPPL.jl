<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transforming variables · DynamicPPL</title><meta name="title" content="Transforming variables · DynamicPPL"/><meta property="og:title" content="Transforming variables · DynamicPPL"/><meta property="twitter:title" content="Transforming variables · DynamicPPL"/><meta name="description" content="Documentation for DynamicPPL."/><meta property="og:description" content="Documentation for DynamicPPL."/><meta property="twitter:description" content="Documentation for DynamicPPL."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body>
<!-- NAVBAR START -->
<style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap');

    /* Documenter.jl CSS Overrides */
    html {
        scroll-padding-top: calc(var(--navbar-height) + 1rem);
    }
    .docs-sidebar, #documenter {
        margin-top: var(--navbar-height);
    }
    .docs-version-selector {
        margin-bottom: 60px !important;
    }
    @media screen and (max-width: 1056px) {
        .docs-version-selector {
            margin-bottom: 60px !important;
        }
        .docs-sidebar {
            margin-top: 0 !important;
        }
    }
    /* End of Documenter.jl Tweaks */

    /* Color and Font Variables */
    :root {
        --heading-color: #6c757d;
        --item-color: rgb(165, 165, 165);
        --primary-bg: white;
        --hover-color: #8faad2;
        --deprecated-bg: #ff4d4d;
        --deprecated-text: white;
        --icon-color: #6c757d;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e9ecef;
        
        /* Typography */
        --font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        --nav-link-font-size: 1.0625rem;
        --turing-title-font-size: 21.25px;
        --icon-font-size: 1.25rem;
        --dropdown-arrow-font-size: 0.6875rem;
        --badge-font-size: 0.75rem;

        /* Sizing and Spacing */
        --navbar-height: 3.75rem;
        --logo-height: 31px;
        --logo-width: auto;
        --logo-padding-top: 7px;
        --logo-margin-left: 0.8rem;
        --title-margin-left: 0.4px;
        --title-nav-spacing: 1.1rem;
        --nav-item-margin-left: 1.3rem;
        --icon-margin-left: 1rem;
        --dropdown-padding: 1.875rem;
        --dropdown-item-width: 12.5rem;
        --dropdown-subitem-width: 15.625rem;
        --dropdown-subitem-padding: 0.125rem 0.625rem;
    }

    /* Dark Theme Variable Overrides */
    html.theme--documenter-dark {
        --heading-color: #e0e0e0;
        --item-color: #bdbdbd;
        --primary-bg: #1f2424;
        --hover-color: #ffffff;
        --icon-color: #e0e0e0;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #424242;
    }

    /* Catppuccin Theme Overrides */
    html.theme--catppuccin-latte {
        --heading-color: #4c4f69;
        --primary-bg: #eff1f5;
        --icon-color: #4c4f69;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e6e9ef;
    }
    html.theme--catppuccin-frappe {
        --heading-color: #c6d0f5;
        --primary-bg: #303446;
        --icon-color: #c6d0f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #51576d;
    }
    html.theme--catppuccin-macchiato {
        --heading-color: #cad3f5;
        --primary-bg: #24273a;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #494d64;
    }
    html.theme--catppuccin-mocha {
        --heading-color: #cad3f5;
        --primary-bg: #1e1e2e;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #45475a;
    }


    /* Main Navigation Bar */
    .ext-navigation {
        font-family: var(--font-family);
        position: fixed;
        height: var(--navbar-height);
        top: 0;
        width: 100%;
        background-color: var(--primary-bg);
        z-index: 1000;
        box-shadow: 0 2px 4px var(--shadow-color);
        display: flex;
        align-items: center;
        padding: 0 1.0625rem;
        transition: transform 0.3s, background-color 0.3s;
    }

    nav.ext-navigation .ext-navbar-logo {
        margin-left: var(--logo-margin-left);
        height: auto;
        max-height: var(--logo-height);
        width: auto;
        padding-top: var(--logo-padding-top);
    }
    
    /* Theme-aware logo text color */
    .ext-navbar-logo .logo-text {
        fill: var(--heading-color);
    }
    
    .ext-navbar-title {
        color: var(--heading-color) !important;
        font-size: var(--turing-title-font-size) !important;
        margin-left: var(--title-margin-left);
        text-decoration: none;
        transition: color 0.2s ease;
    }
    
    .ext-navbar-title:hover {
        color: var(--hover-color) !important;
    }

    .ext-nav-links {
        display: flex;
        align-items: center;
        list-style-type: none;
        margin: 0;
        padding: 0;
        flex-grow: 1;
        margin-left: var(--title-nav-spacing);
    }

    .ext-nav-links li:first-child {
        margin-left: 0 !important;
    }

    .ext-nav-links li {
        margin-left: var(--nav-item-margin-left) !important;
    }

    .ext-nav-link {
        color: var(--heading-color) !important;
        text-decoration: none;
        font-size: var(--nav-link-font-size) !important;
        transition: color 0.2s ease;
        cursor: pointer;
    }

    .ext-nav-link:hover,
    .ext-navbar-item-single a:hover,
    .ext-navbar-icons a:hover {
        color: var(--hover-color) !important;
    }

    .ext-navbar-item-single a {
        color: var(--heading-color) !important;
    }
    
    .ext-navbar-icons {
        display: flex;
        align-items: center;
    }

    .ext-navbar-icons a {
        color: var(--icon-color) !important;
        font-size: var(--icon-font-size) !important;
        transition: color 0.2s ease;
        margin-left: var(--icon-margin-left);
    }

    .ext-menu-toggle {
        display: none;
        font-size: 1.5rem;
        color: var(--heading-color);
        cursor: pointer;
    }

    .ext-dropdown {
        display: none;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        padding: var(--dropdown-padding);
        position: absolute;
        top: var(--navbar-height);
        width: 100%;
        left: 0;
        background-color: var(--primary-bg);
        line-height: 1.875rem;
        opacity: 0;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, background-color 0.3s;
        transform: translateY(-0.625rem);
        box-shadow: 0 4px 6px var(--shadow-color);
    }

    #library-handler::after {
        content: "▼";
        font-size: var(--dropdown-arrow-font-size);
        margin-left: 0.3125rem;
        transition: transform 0.3s ease-in-out;
    }

    #library-handler.open::after {
        content: "▲";
    }

    .ext-dropdown.show {
        display: grid;
        opacity: 1;
        transform: translateY(0);
    }

    .ext-dropdown ul {
        width: var(--dropdown-item-width);
        margin-bottom: 1.25rem;
    }

    .ext-dropdown ul li {
        text-align: left;
        display: flex;
        align-items: center;
    }

    .ext-dropdown ul a li {
        color: var(--item-color);
        width: var(--dropdown-subitem-width);
        border-radius: 3px;
        padding: var(--dropdown-subitem-padding);
        transition: background-color 0.2s ease;
    }

    .ext-dropdown ul a li:hover {
        background-color: var(--dropdown-hover-bg);
    }

    .ext-dropdown-item-heading {
        color: var(--heading-color);
        text-align: center;
    }

    .deprecated-badge {
        background-color: var(--deprecated-bg);
        color: var(--deprecated-text);
        font-size: var(--badge-font-size);
        padding: .1rem;
        border-radius: 3px;
        margin-left: 0.5rem;
        line-height: 1;
    }

    @media (max-width: 966px) {
        .ext-dropdown {
            grid-template-columns: 1fr 1fr 1fr;
        }
    }

    @media (max-width: 768px) {
        .ext-nav-links {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            background-color: var(--primary-bg);
            position: absolute;
            top: var(--navbar-height);
            left: 0;
            padding: 0.625rem 0;
            height: auto;
            overflow-y: auto;
            box-shadow: 0 4px 6px var(--shadow-color);
            margin-left: 0;
        }

        .ext-nav-links.show {
            display: flex;
        }

        .ext-nav-links li {
            margin: 0.625rem 0 !important;
            text-align: center;
        }
        
        .ext-menu-toggle {
            display: block;
            margin-left: auto;
        }

        .ext-navigation.hide {
            transform: translateY(calc(-1 * var(--navbar-height)));
        }

        .ext-dropdown {
            position: static;
            display: block;
            opacity: 1;
            transform: none;
            box-shadow: none;
            grid-template-columns: 1fr;
            padding: 0.625rem;
            text-align: center;
        }

        .ext-dropdown ul {
            width: auto;
            display: inline-block;
            margin: 0 auto 0.3125rem;
            text-align: left;
        }
    }
</style>
<nav class="ext-navigation">
    <a href="https://turinglang.org/">
        <svg width="4333" height="1145" viewBox="0 0 4333 1145" fill="none" xmlns="http://www.w3.org/2000/svg" class="ext-navbar-logo">
            <path class="logo-text" d="M0.44603 193.181V66.9868H663.471V193.181H406.62V898H257.297V193.181H0.44603ZM1097.24 635.874V274.74H1244.13V898H1101.7V787.225H1095.21C1081.14 822.121 1058.01 850.66 1025.82 872.842C993.902 895.024 954.542 906.115 907.744 906.115C866.896 906.115 830.783 897.053 799.403 878.929C768.295 860.534 743.948 833.889 726.365 798.993C708.782 763.826 699.99 721.356 699.99 671.581V274.74H846.878V648.858C846.878 688.353 857.699 719.733 879.34 742.997C900.981 766.261 929.385 777.893 964.551 777.893C986.192 777.893 1007.16 772.618 1027.45 762.068C1047.73 751.518 1064.37 735.828 1077.35 714.999C1090.61 693.899 1097.24 667.524 1097.24 635.874ZM1395.17 898V274.74H1537.6V378.617H1544.09C1555.45 342.639 1574.93 314.911 1602.52 295.434C1630.38 275.687 1662.17 265.813 1697.88 265.813C1705.99 265.813 1715.05 266.219 1725.06 267.031C1735.34 267.572 1743.86 268.518 1750.63 269.871V404.992C1744.4 402.828 1734.53 400.934 1721 399.311C1707.75 397.417 1694.9 396.471 1682.46 396.471C1655.68 396.471 1631.6 402.287 1610.23 413.919C1589.13 425.28 1572.49 441.105 1560.32 461.393C1548.15 481.682 1542.06 505.081 1542.06 531.591V898H1395.17ZM1848.21 898V274.74H1995.1V898H1848.21ZM1922.06 186.283C1898.8 186.283 1878.78 178.573 1862.01 163.154C1845.24 147.464 1836.85 128.664 1836.85 106.752C1836.85 84.5701 1845.24 65.7695 1862.01 50.3503C1878.78 34.6606 1898.8 26.8158 1922.06 26.8158C1945.6 26.8158 1965.61 34.6606 1982.12 50.3503C1998.89 65.7695 2007.27 84.5701 2007.27 106.752C2007.27 128.664 1998.89 147.464 1982.12 163.154C1965.61 178.573 1945.6 186.283 1922.06 186.283ZM2293.04 532.809V898H2146.15V274.74H2286.54V380.646H2293.85C2308.18 345.75 2331.04 318.022 2362.42 297.463C2394.07 276.904 2433.16 266.625 2479.69 266.625C2522.7 266.625 2560.17 275.822 2592.09 294.217C2624.28 312.612 2649.17 339.257 2666.75 374.153C2684.6 409.049 2693.39 451.385 2693.12 501.159V898H2546.24V523.882C2546.24 482.223 2535.41 449.626 2513.77 426.092C2492.4 402.557 2462.78 390.79 2424.91 390.79C2399.21 390.79 2376.35 396.471 2356.34 407.832C2336.59 418.923 2321.03 435.019 2309.67 456.119C2298.58 477.218 2293.04 502.782 2293.04 532.809ZM3113.5 1144.71C3060.75 1144.71 3015.44 1137.54 2977.57 1123.2C2939.7 1109.13 2909.26 1090.2 2886.27 1066.39C2863.28 1042.59 2847.32 1016.21 2838.39 987.269L2970.67 955.213C2976.62 967.386 2985.28 979.424 2996.64 991.327C3008 1003.5 3023.28 1013.51 3042.49 1021.35C3061.97 1029.47 3086.45 1033.53 3115.93 1033.53C3157.59 1033.53 3192.08 1023.38 3219.4 1003.09C3246.73 983.076 3260.39 950.074 3260.39 904.087V786.008H3253.08C3245.51 801.157 3234.42 816.711 3219.81 832.671C3205.47 848.632 3186.4 862.022 3162.6 872.842C3139.06 883.663 3109.44 889.073 3073.73 889.073C3025.85 889.073 2982.44 877.847 2943.48 855.394C2904.8 832.671 2873.96 798.857 2850.97 753.952C2828.24 708.777 2816.88 652.24 2816.88 584.341C2816.88 515.902 2828.24 458.147 2850.97 411.078C2873.96 363.739 2904.93 327.896 2943.89 303.55C2982.84 278.933 3026.26 266.625 3074.14 266.625C3110.66 266.625 3140.69 272.847 3164.22 285.29C3188.03 297.463 3206.96 312.206 3221.03 329.519C3235.09 346.561 3245.78 362.657 3253.08 377.805H3261.2V274.74H3406.06V908.144C3406.06 961.435 3393.34 1005.53 3367.92 1040.42C3342.49 1075.32 3307.73 1101.43 3263.63 1118.74C3219.54 1136.05 3169.5 1144.71 3113.5 1144.71ZM3114.72 773.835C3145.83 773.835 3172.34 766.261 3194.25 751.112C3216.16 735.963 3232.79 714.187 3244.16 685.783C3255.52 657.379 3261.2 623.295 3261.2 583.53C3261.2 544.305 3255.52 509.95 3244.16 480.465C3233.07 450.979 3216.56 428.12 3194.65 411.89C3173.01 395.389 3146.37 387.138 3114.72 387.138C3081.98 387.138 3054.66 395.659 3032.75 412.701C3010.84 429.744 2994.34 453.143 2983.25 482.899C2972.16 512.385 2966.61 545.929 2966.61 583.53C2966.61 621.672 2972.16 655.08 2983.25 683.754C2994.61 712.158 3011.25 734.34 3033.16 750.3C3055.34 765.99 3082.53 773.835 3114.72 773.835ZM3647.08 906.927C3622.47 906.927 3601.37 898.271 3583.78 880.958C3566.2 863.645 3557.54 842.545 3557.82 817.658C3557.54 793.312 3566.2 772.482 3583.78 755.17C3601.37 737.857 3622.47 729.2 3647.08 729.2C3670.89 729.2 3691.58 737.857 3709.17 755.17C3727.02 772.482 3736.08 793.312 3736.35 817.658C3736.08 834.159 3731.75 849.173 3723.37 862.698C3715.25 876.224 3704.43 887.044 3690.91 895.16C3677.65 903.004 3663.04 906.927 3647.08 906.927ZM3888.01 274.74H4034.9V933.708C4034.9 978.613 4026.38 1015.67 4009.33 1044.89C3992.29 1074.1 3967.67 1095.88 3935.48 1110.22C3903.29 1124.55 3864.2 1131.72 3818.22 1131.72C3812.81 1131.72 3807.8 1131.59 3803.2 1131.32C3798.6 1131.32 3793.6 1131.18 3788.19 1130.91V1011.21C3792.25 1011.48 3795.9 1011.62 3799.15 1011.62C3802.39 1011.89 3805.77 1012.02 3809.29 1012.02C3837.42 1012.02 3857.58 1005.12 3869.75 991.327C3881.92 977.801 3888.01 957.918 3888.01 931.679V274.74ZM3961.05 186.283C3937.51 186.283 3917.36 178.573 3900.59 163.154C3884.09 147.464 3875.84 128.664 3875.84 106.752C3875.84 84.5701 3884.09 65.7695 3900.59 50.3503C3917.36 34.6606 3937.51 26.8158 3961.05 26.8158C3984.31 26.8158 4004.19 34.6606 4020.7 50.3503C4037.47 65.7695 4045.85 84.5701 4045.85 106.752C4045.85 128.664 4037.47 147.464 4020.7 163.154C4004.19 178.573 3984.31 186.283 3961.05 186.283ZM4332.83 66.9868V898H4185.94V66.9868H4332.83Z" fill="currentColor"/>
            <path d="M4076 108.5C4076 168.424 4027.42 217 3967.5 217C3907.58 217 3859 168.424 3859 108.5C3859 48.5762 3907.58 0 3967.5 0C4027.42 0 4076 48.5762 4076 108.5Z" fill="#389725"/>
            <path d="M3755 814.5C3755 874.424 3706.42 923 3646.5 923C3586.58 923 3538 874.424 3538 814.5C3538 754.576 3586.58 706 3646.5 706C3706.42 706 3755 754.576 3755 814.5Z" fill="#9457B1"/>
            <path d="M2030 108.5C2030 168.424 1981.42 217 1921.5 217C1861.58 217 1813 168.424 1813 108.5C1813 48.5762 1861.58 0 1921.5 0C1981.42 0 2030 48.5762 2030 108.5Z" fill="#CA3B33"/>
        </svg>
    </a>
    <!-- <a class="ext-navbar-title" href="https://turinglang.org/">Turing.jl</a> -->
    
    <ul class="ext-nav-links">
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/getting-started/">Get Started</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/tutorials/">Tutorials</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/faq/">FAQ</a></li>
        <li>
            <p class="ext-nav-link" id="library-handler">Libraries</p>
            <div class="ext-dropdown" id="ext-dropdown-items">
                <ul>
                    <li class="ext-dropdown-item-heading">Modelling Languages</li>
                    <a href="https://turinglang.org/DynamicPPL.jl/"><li>DynamicPPL</li></a>
                    <a href="https://turinglang.org/JuliaBUGS.jl/"><li>JuliaBUGS</li></a>
                    <a href="https://turinglang.org/TuringGLM.jl/"><li>TuringGLM</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">MCMC</li>
                    <a href="https://turinglang.org/AdvancedHMC.jl/"><li>AdvancedHMC</li></a>
                    <a href="https://turinglang.org/AbstractMCMC.jl/"><li>AbstractMCMC</li></a>
                    <a href="https://github.com/theogf/ThermodynamicIntegration.jl"><li>ThermodynamicIntegration</li></a>
                    <a href="https://turinglang.org/AdvancedPS.jl/"><li>AdvancedPS</li></a>
                    <a href="https://turinglang.org/SliceSampling.jl/"><li>SliceSampling</li></a>
                    <a href="https://turinglang.org/EllipticalSliceSampling.jl/"><li>EllipticalSliceSampling</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Diagnostics</li>
                    <a href="https://turinglang.org/MCMCChains.jl/"><li>MCMCChains</li></a>
                    <a href="https://turinglang.org/MCMCDiagnosticTools.jl/"><li>MCMCDiagnosticTools</li></a>
                    <a href="https://chalk-lab.github.io/ParetoSmooth.jl/"><li>ParetoSmooth</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Gaussian Processes</li>
                    <a href="https://juliagaussianprocesses.github.io/AbstractGPs.jl/"><li>AbstractGPs</li></a>
                    <a href="https://juliagaussianprocesses.github.io/KernelFunctions.jl/"><li>KernelFunctions</li></a>
                    <a href="https://juliagaussianprocesses.github.io/ApproximateGPs.jl/"><li>ApproximateGPs</li></a>
                </ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Bijectors.jl/">Bijectors</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/TuringCallbacks.jl/">TuringCallbacks</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Deprecated/TuringBenchmarking/">TuringBenchmarking</a><span class="deprecated-badge">Deprecated</span></li></ul>
            </div>
        </li>
        <li><a class="ext-nav-link" href="https://turinglang.org/news/">News</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/team/">Team</a></li>
    </ul>

    <div class="ext-navbar-icons">
        <a href="https://x.com/TuringLang" aria-label="Turing on X"><i class="fa-brands fa-x-twitter"></i></a>
        <a href="https://discourse.julialang.org/c/domain/probprog/48" aria-label="Turing on Discourse"><i class="fa-brands fa-discourse"></i></a>
        <a href="https://julialang.slack.com/archives/CCYDC34A0" aria-label="Turing on Slack"><i class="fa-brands fa-slack"></i></a>
        <a href="https://github.com/TuringLang/" aria-label="Turing.jl on GitHub"><i class="fa-brands fa-github"></i></a>
    </div>

    <span class="ext-menu-toggle"><i class="fa-solid fa-bars"></i></span>
</nav>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".ext-menu-toggle");
        const navLinks = document.querySelector(".ext-nav-links");
        const nav = document.querySelector(".ext-navigation");
        const libraryHandler = document.getElementById("library-handler");
        const dropdownContainer = document.getElementById("ext-dropdown-items");
        let lastScrollY = window.scrollY;

        function closeDropdown() {
            if (dropdownContainer.classList.contains("show")) {
                libraryHandler.classList.remove("open");
                dropdownContainer.classList.remove("show");
                setTimeout(() => {
                    if (!dropdownContainer.classList.contains("show")) {
                        dropdownContainer.style.display = "none";
                    }
                }, 300);
            }
        }

        function openDropdown() {
            dropdownContainer.style.display = "grid";
            libraryHandler.classList.add("open");
            setTimeout(() => {
                dropdownContainer.classList.add("show");
            }, 10);
        }

        function setAppropriateHeight() {
            if (window.innerWidth <= 768) {
                const viewportHeight = window.innerHeight;
                const navHeight = nav.offsetHeight;
                navLinks.style.maxHeight = `${viewportHeight - navHeight}px`;
                navLinks.style.overflowY = "auto";
            } else {
                navLinks.style.maxHeight = "";
                navLinks.style.overflowY = "";
            }
        }

        menuToggle.addEventListener("click", (event) => {
            event.stopPropagation();
            navLinks.classList.toggle("show");
            if (navLinks.classList.contains("show")) {
                setAppropriateHeight();
                closeDropdown();
                dropdownContainer.style.display = "none";
            }
        });

        libraryHandler.addEventListener("click", (event) => {
            event.stopPropagation();
            event.preventDefault();
            if (dropdownContainer.classList.contains("show")) {
                closeDropdown();
            } else {
                openDropdown();
            }
            setAppropriateHeight();
        });

        // Close all menus if a click is registered outside the navigation bar.
        document.addEventListener("click", (event) => {
            if (!nav.contains(event.target)) {
                navLinks.classList.remove("show");
                closeDropdown();
            }
        });

        // Hide navigation bar on scroll down in mobile view.
        window.addEventListener("scroll", () => {
            if (window.innerWidth <= 768) {
                if (window.scrollY > lastScrollY && window.scrollY > nav.offsetHeight){
                    nav.classList.add("hide");
                } else {
                    nav.classList.remove("hide");
                }
                lastScrollY = window.scrollY;
            }
        });

        window.addEventListener("resize", setAppropriateHeight);
    });
</script>
<!-- NAVBAR END -->



<div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="DynamicPPL logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DynamicPPL</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../varinfo/">Design of <code>VarInfo</code></a></li><li class="is-active"><a class="tocitem" href>Transforming variables</a><ul class="internal"><li><a class="tocitem" href="#Motivation"><span>Motivation</span></a></li><li><a class="tocitem" href="#What-do-we-need?"><span>What do we need?</span></a></li><li><a class="tocitem" href="#Working-example"><span>Working example</span></a></li><li><a class="tocitem" href="#From-internal-representation-to-model-representation"><span>From internal representation to model representation</span></a></li><li><a class="tocitem" href="#From-*unconstrained*-internal-representation-to-model-representation"><span>From <em>unconstrained</em> internal representation to model representation</span></a></li><li><a class="tocitem" href="#Why-do-we-need-both-to_internal_transform-and-to_linked_internal_transform?"><span>Why do we need both <code>to_internal_transform</code> and <code>to_linked_internal_transform</code>?</span></a></li><li><a class="tocitem" href="#Other-functionalities"><span>Other functionalities</span></a></li><li class="toplevel"><a class="tocitem" href="#Supporting-a-new-distribution"><span>Supporting a new distribution</span></a></li><li class="toplevel"><a class="tocitem" href="#TL;DR"><span>TL;DR</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internals</a></li><li class="is-active"><a href>Transforming variables</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transforming variables</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TuringLang/DynamicPPL.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/TuringLang/DynamicPPL.jl/blob/master/docs/src/internals/transformations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Transforming-variables"><a class="docs-heading-anchor" href="#Transforming-variables">Transforming variables</a><a id="Transforming-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Transforming-variables" title="Permalink"></a></h1><h2 id="Motivation"><a class="docs-heading-anchor" href="#Motivation">Motivation</a><a id="Motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Motivation" title="Permalink"></a></h2><p>In a probabilistic programming language (PPL) such as DynamicPPL.jl, one crucial functionality for enabling a large number of inference algorithms to be implemented, in particular gradient-based ones, is the ability to work with &quot;unconstrained&quot; variables.</p><p>For example, consider the following model:</p><pre><code class="language-julia hljs">@model function demo()
    s ~ InverseGamma(2, 3)
    return m ~ Normal(0, √s)
end</code></pre><p>Here we have two variables <code>s</code> and <code>m</code>, where <code>s</code> is constrained to be positive, while <code>m</code> can be any real number.</p><p>For certain inference methods, it&#39;s necessary / much more convenient to work with an equivalent model to <code>demo</code> but where all the variables can take any real values (they&#39;re &quot;unconstrained&quot;).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We write &quot;unconstrained&quot; with quotes because there are many ways to transform a constrained variable to an unconstrained one, <em>and</em> DynamicPPL can work with a much broader class of bijective transformations of variables, not just ones that go to the entire real line. But for MCMC, unconstraining is the most common transformation so we&#39;ll stick with that terminology.</p></div></div><p>For a large family of constraints encountered in practice, it is indeed possible to transform a (partially) constrained model to a completely unconstrained one in such a way that sampling in the unconstrained space is equivalent to sampling in the constrained space.</p><p>In DynamicPPL.jl, this is often referred to as <em>linking</em> (a term originating in the statistics literature) and is done using transformations from <a href="https://github.com/TuringLang/Bijectors.jl">Bijectors.jl</a>.</p><p>For example, the above model could be transformed into (the following pseudo-code; it&#39;s not working code):</p><pre><code class="language-julia hljs">@model function demo()
    log_s ~ log(InverseGamma(2, 3))
    s = exp(log_s)
    return m ~ Normal(0, √s)
end</code></pre><p>Here <code>log_s</code> is an unconstrained variable, and <code>s</code> is a constrained variable that is a deterministic function of <code>log_s</code>.</p><p>But to ensure that we stay consistent with what the user expects, DynamicPPL.jl does not actually transform the model as above, but instead makes use of transformed variables internally to achieve the same effect, when desired.</p><p>In the end, we&#39;ll end up with something that looks like this:</p><div class="mermaid">%%{ init: { &#39;themeVariables&#39;: { &#39;lineColor&#39;: &#39;#000000&#39; } } }%%
%%{ init: { &#39;flowchart&#39;: { &#39;curve&#39;: &#39;linear&#39; } } }%%
graph TD
    subgraph assume [&quot;assume&quot;]
        style assume fill:#ffffff,font-family:Courier

        A[&quot;x ~ Normal()&quot;]:::boxStyle
        B[&quot;vn = &lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;@varname&lt;/span&gt;(x)&lt;br&gt;dist = Normal()&lt;br&gt;x, vi = ...&quot;]:::boxStyle
        C[&quot;assume(vn, dist, vi)&quot;]:::boxStyle
        D([&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;if&lt;/span&gt; istrans(vi, vn)&quot;]):::boxStyle
        E[&quot;f = from_internal_transform(vi, vn, dist)&quot;]:::boxStyle
        F[&quot;f = from_linked_internal_transform(vi, vn, dist)&quot;]:::boxStyle
        G[&quot;x, logjac = with_logabsdet_jacobian(f, getindex_internal(vi, vn, dist))&quot;]:::boxStyle
        H[&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;return&lt;/span&gt; x, logpdf(dist, x) - logjac, vi&quot;]:::boxStyle
        
        A -.-&gt;|&lt;span style=&#39;color:#3B6EA8 ; background-color:#ffffff;&#39;&gt;@model&lt;/span&gt;| B
        B -.-&gt;|&lt;span style=&#39;color:#000000 ; background-color:#ffffff;&#39;&gt;tilde-pipeline&lt;/span&gt;| C
        C --&gt; D
        D --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;false&lt;/span&gt;| E
        D --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;true&lt;/span&gt;| F
        E --&gt; G
        F --&gt; G
        G --&gt; H
    end

    classDef boxStyle fill:#ffffff,stroke:#000000,font-family:Courier,color:#000000
    
    linkStyle default stroke:#000000,stroke-width:1px,color:#000000</div><p>Below we&#39;ll see how this is done.</p><h2 id="What-do-we-need?"><a class="docs-heading-anchor" href="#What-do-we-need?">What do we need?</a><a id="What-do-we-need?-1"></a><a class="docs-heading-anchor-permalink" href="#What-do-we-need?" title="Permalink"></a></h2><p>There are two aspects to transforming from the internal representation of a variable in a <code>varinfo</code> to the representation wanted in the model:</p><ol><li><p>Different implementations of <a href="../../api/#DynamicPPL.AbstractVarInfo"><code>AbstractVarInfo</code></a> represent realizations of a model in different ways internally, so we need to transform from this internal representation to the desired representation in the model. For example,</p><ul><li><a href="../../api/#VarInfo"><code>VarInfo</code></a> represents a realization of a model as a &quot;flattened&quot; / vector representation, regardless of the form of the variable in the model.</li><li><a href="../../api/#SimpleVarInfo"><code>SimpleVarInfo</code></a> represents a realization of a model exactly as in the model (unless it has been transformed; we&#39;ll get to that later).</li></ul></li><li><p>We need the ability to transform from &quot;constrained space&quot; to &quot;unconstrained space&quot;, as we saw in the previous section.</p></li></ol><h2 id="Working-example"><a class="docs-heading-anchor" href="#Working-example">Working example</a><a id="Working-example-1"></a><a class="docs-heading-anchor-permalink" href="#Working-example" title="Permalink"></a></h2><p>A good and non-trivial example to keep in mind throughout is the following model:</p><pre><code class="language-julia hljs">using DynamicPPL, Distributions
@model demo_lkj() = x ~ LKJCholesky(2, 1.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">demo_lkj (generic function with 2 methods)</code></pre><p><code>LKJCholesky</code> is a <code>LKJ(2, 1.0)</code> distribution, a distribution over correlation matrices (covariance matrices but with unit diagonal), but working directly with the Cholesky factorization of the correlation matrix rather than the correlation matrix itself (this is more numerically stable and computationally efficient).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This is a particularly &quot;annoying&quot; case because the return-value is not a simple <code>Real</code> or <code>AbstractArray{&lt;:Real}</code>, but rather a <code>LineraAlgebra.Cholesky</code> object which wraps a triangular matrix (whether it&#39;s upper- or lower-triangular depends on the instance).</p></div></div><p>As mentioned, some implementations of <code>AbstractVarInfo</code>, e.g. <a href="../../api/#VarInfo"><code>VarInfo</code></a>, works with a &quot;flattened&quot; / vector representation of a variable, and so in this case we need two transformations:</p><ol><li>From the <code>Cholesky</code> object to a vector representation.</li><li>From the <code>Cholesky</code> object to an &quot;unconstrained&quot; / linked vector representation.</li></ol><p>And similarly, we&#39;ll need the inverses of these transformations.</p><h2 id="From-internal-representation-to-model-representation"><a class="docs-heading-anchor" href="#From-internal-representation-to-model-representation">From internal representation to model representation</a><a id="From-internal-representation-to-model-representation-1"></a><a class="docs-heading-anchor-permalink" href="#From-internal-representation-to-model-representation" title="Permalink"></a></h2><p>To go from the internal variable representation of an <code>AbstractVarInfo</code> to the variable representation wanted in the model, e.g. from a <code>Vector{Float64}</code> to <code>Cholesky</code> in the case of <a href="../../api/#VarInfo"><code>VarInfo</code></a> in <code>demo_lkj</code>, we have the following methods:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.to_internal_transform" href="#DynamicPPL.to_internal_transform"><code>DynamicPPL.to_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">to_internal_transform(varinfo::AbstractVarInfo, vn::VarName[, dist])</code></pre><p>Return a transformation that transforms from a representation compatible with <code>dist</code> to the internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L842-L849">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.from_internal_transform" href="#DynamicPPL.from_internal_transform"><code>DynamicPPL.from_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">from_internal_transform(varinfo::AbstractVarInfo, vn::VarName[, dist])</code></pre><p>Return a transformation that transforms from the internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code> to a representation compatible with <code>dist</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L799-L806">source</a></section></article><p>These methods allow us to extract the internal-to-model transformation function depending on the <code>varinfo</code>, the variable, and the distribution of the variable:</p><ul><li><code>varinfo</code> + <code>vn</code> defines the internal representation of the variable.</li><li><code>dist</code> defines the representation expected within the model scope.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If <code>vn</code> is not present in <code>varinfo</code>, then the internal representation is fully determined by <code>varinfo</code> alone. This is used when we&#39;re about to add a new variable to the <code>varinfo</code> and need to know how to represent it internally.</p></div></div><p>Continuing from the example above, we can inspect the internal representation of <code>x</code> in <code>demo_lkj</code> with <a href="../../api/#VarInfo"><code>VarInfo</code></a> using <a href="../../api/#DynamicPPL.getindex_internal"><code>DynamicPPL.getindex_internal</code></a>:</p><pre><code class="language-julia hljs">model = demo_lkj()
varinfo = VarInfo(model)
x_internal = DynamicPPL.getindex_internal(varinfo, @varname(x))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
 1.0
 0.5303967132116536
 0.0
 0.8477495659770489</code></pre><pre><code class="language-julia hljs">f_from_internal = DynamicPPL.from_internal_transform(
    varinfo, @varname(x), LKJCholesky(2, 1.0)
)
f_from_internal(x_internal)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearAlgebra.Cholesky{Float64, Matrix{Float64}}
L factor:
2×2 LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}:
 1.0        ⋅ 
 0.530397  0.84775</code></pre><p>Let&#39;s confirm that this is the same as <code>varinfo[@varname(x)]</code>:</p><pre><code class="language-julia hljs">x_model = varinfo[@varname(x)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearAlgebra.Cholesky{Float64, Matrix{Float64}}
L factor:
2×2 LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}:
 1.0        ⋅ 
 0.530397  0.84775</code></pre><p>Similarly, we can go from the model representation to the internal representation:</p><pre><code class="language-julia hljs">f_to_internal = DynamicPPL.to_internal_transform(varinfo, @varname(x), LKJCholesky(2, 1.0))

f_to_internal(x_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element reshape(::LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}, 4) with eltype Float64:
 1.0
 0.5303967132116536
 0.0
 0.8477495659770489</code></pre><p>It&#39;s also useful to see how this is done in <a href="../../api/#SimpleVarInfo"><code>SimpleVarInfo</code></a>:</p><pre><code class="language-julia hljs">simple_varinfo = SimpleVarInfo(varinfo)
DynamicPPL.getindex_internal(simple_varinfo, @varname(x))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearAlgebra.Cholesky{Float64, Matrix{Float64}}
L factor:
2×2 LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}:
 1.0        ⋅ 
 0.530397  0.84775</code></pre><p>Here see that the internal representation is exactly the same as the model representation, and so we&#39;d expect <code>from_internal_transform</code> to be the <code>identity</code> function:</p><pre><code class="language-julia hljs">DynamicPPL.from_internal_transform(simple_varinfo, @varname(x), LKJCholesky(2, 1.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">identity (generic function with 1 method)</code></pre><p>Great!</p><h2 id="From-*unconstrained*-internal-representation-to-model-representation"><a class="docs-heading-anchor" href="#From-*unconstrained*-internal-representation-to-model-representation">From <em>unconstrained</em> internal representation to model representation</a><a id="From-*unconstrained*-internal-representation-to-model-representation-1"></a><a class="docs-heading-anchor-permalink" href="#From-*unconstrained*-internal-representation-to-model-representation" title="Permalink"></a></h2><p>In addition to going from internal representation to model representation of a variable, we also need to be able to go from the <em>unconstrained</em> internal representation to the model representation.</p><p>For this, we have the following methods:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.to_linked_internal_transform" href="#DynamicPPL.to_linked_internal_transform"><code>DynamicPPL.to_linked_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">to_linked_internal_transform(varinfo::AbstractVarInfo, vn::VarName[, dist])</code></pre><p>Return a transformation that transforms from a representation compatible with <code>dist</code> to the linked internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L857-L864">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.from_linked_internal_transform" href="#DynamicPPL.from_linked_internal_transform"><code>DynamicPPL.from_linked_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">from_linked_internal_transform(varinfo::AbstractVarInfo, vn::VarName[, dist])</code></pre><p>Return a transformation that transforms from the linked internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code> to a representation compatible with <code>dist</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L809-L816">source</a></section></article><p>These are very similar to <a href="#DynamicPPL.to_internal_transform"><code>DynamicPPL.to_internal_transform</code></a> and <a href="#DynamicPPL.from_internal_transform"><code>DynamicPPL.from_internal_transform</code></a>, but here the internal representation is also linked / &quot;unconstrained&quot;.</p><p>Continuing from the example above:</p><pre><code class="language-julia hljs">f_to_linked_internal = DynamicPPL.to_linked_internal_transform(
    varinfo, @varname(x), LKJCholesky(2, 1.0)
)

x_linked_internal = f_to_linked_internal(x_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Float64}:
 0.5906970014223764</code></pre><pre><code class="language-julia hljs">f_from_linked_internal = DynamicPPL.from_linked_internal_transform(
    varinfo, @varname(x), LKJCholesky(2, 1.0)
)

f_from_linked_internal(x_linked_internal)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearAlgebra.Cholesky{Float64, Matrix{Float64}}
L factor:
2×2 LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}:
 1.0        ⋅ 
 0.530397  0.84775</code></pre><p>Here we see a significant difference between the linked representation and the non-linked representation: the linked representation is only of length 1, whereas the non-linked representation is of length 4. This is because we actually only need a single element to represent a 2x2 correlation matrix, as the diagonal elements are always 1 <em>and</em> it&#39;s symmetric.</p><p>We can also inspect the transforms themselves:</p><pre><code class="language-julia hljs">f_from_internal</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DynamicPPL.ToChol(&#39;L&#39;) ∘ DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{Int64, Int64}}((4,), (2, 2))</code></pre><p>vs.</p><pre><code class="language-julia hljs">f_from_linked_internal</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Bijectors.Inverse{Bijectors.VecCholeskyBijector}(Bijectors.VecCholeskyBijector(:L))</code></pre><p>Here we see that <code>f_from_linked_internal</code> is a single function taking us directly from the linked representation to the model representation, whereas <code>f_from_internal</code> is a composition of a few functions: one reshaping the underlying length 4 array into 2x2 matrix, and the other converting this matrix into a <code>Cholesky</code>, as required to be compatible with <code>LKJCholesky(2, 1.0)</code>.</p><h2 id="Why-do-we-need-both-to_internal_transform-and-to_linked_internal_transform?"><a class="docs-heading-anchor" href="#Why-do-we-need-both-to_internal_transform-and-to_linked_internal_transform?">Why do we need both <code>to_internal_transform</code> and <code>to_linked_internal_transform</code>?</a><a id="Why-do-we-need-both-to_internal_transform-and-to_linked_internal_transform?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-do-we-need-both-to_internal_transform-and-to_linked_internal_transform?" title="Permalink"></a></h2><p>One might wonder why we need both <code>to_internal_transform</code> and <code>to_linked_internal_transform</code> instead of just a single <code>to_internal_transform</code> which returns the &quot;standard&quot; internal representation if the variable is not linked / &quot;unconstrained&quot; and the linked / &quot;unconstrained&quot; internal representation if it is.</p><p>That is, why can&#39;t we just do</p><div class="mermaid">%%{ init: { &#39;flowchart&#39;: { &#39;curve&#39;: &#39;linear&#39; } } }%%
%%{ init: { &#39;themeVariables&#39;: { &#39;lineColor&#39;: &#39;#000000&#39; } } }%%
graph TD
    subgraph assume [&quot;assume&quot;]
        style assume fill:#ffffff,font-family:Courier

        A[&quot;assume(varinfo, &lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;@varname&lt;/span&gt;(x), Normal())&quot;]:::boxStyle
        B[&quot;f = from_internal_transform(varinfo, varname, dist)&quot;]:::boxStyle
        C[&quot;x, logjac = with_logabsdet_jacobian(f, assume_internal(varinfo, varname, dist))&quot;]:::boxStyle
        D[&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;return&lt;/span&gt; x, logpdf(dist, x) - logjac, varinfo&quot;]:::dashedBox
        
        A --&gt; B
        B --&gt; C
        C --&gt; D
    end

    classDef dashedBox fill:#ffffff,stroke:#000000,stroke-dasharray: 5 5,font-family:Courier,color:#000000
    classDef boxStyle fill:#ffffff,stroke:#000000,font-family:Courier,color:#000000

    linkStyle default stroke:#000000,stroke-width:1px,color:#000000</div><p>Unfortunately, this is not possible in general. Consider for example the following model:</p><pre><code class="language-julia hljs">@model function demo_dynamic_constraint()
    m ~ Normal()
    x ~ truncated(Normal(); lower=m)

    return (m=m, x=x)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">demo_dynamic_constraint (generic function with 2 methods)</code></pre><p>Here the variable <code>x</code> is constrained to be in the domain <code>(m, Inf)</code>, where <code>m</code> is sampled according to a <code>Normal</code>.</p><pre><code class="language-julia hljs">model = demo_dynamic_constraint()
varinfo = VarInfo(model)
varinfo[@varname(m)], varinfo[@varname(x)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.27342216759982785, 0.7468437832993746)</code></pre><p>We see that the realization of <code>x</code> is indeed greater than <code>m</code>, as expected.</p><p>But what if we <a href="../../api/#Bijectors.link"><code>link</code></a> this <code>varinfo</code> so that we end up working on an &quot;unconstrained&quot; space, i.e. both <code>m</code> and <code>x</code> can take on any values in <code>(-Inf, Inf)</code>:</p><pre><code class="language-julia hljs">varinfo_linked = link(varinfo, model)
varinfo_linked[@varname(m)], varinfo_linked[@varname(x)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.27342216759982785, 0.7468437832993746)</code></pre><p>Still get the same values, as expected, since internally <code>varinfo</code> transforms from the linked internal representation to the model representation.</p><p>But what if we change the value of <code>m</code>, to, say, a bit larger than <code>x</code>?</p><pre><code class="language-julia hljs"># Update realization for `m` in `varinfo_linked`.
varinfo_linked[@varname(m)] = varinfo_linked[@varname(x)] + 1
varinfo_linked[@varname(m)], varinfo_linked[@varname(x)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(1.7468437832993746, 0.7468437832993746)</code></pre><p>Now we see that the constraint <code>m &lt; x</code> is no longer satisfied!</p><p>Hence one might expect that if we try to compute, say, the <a href="../../api/#DynamicPPL.logjoint"><code>logjoint</code></a> using <code>varinfo_linked</code> with this &quot;invalid&quot; realization, we&#39;ll get an error:</p><pre><code class="language-julia hljs">logjoint(model, varinfo_linked)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-3.365562179406999</code></pre><p>But we don&#39;t! In fact, if we look at the actual value used within the model</p><pre><code class="language-julia hljs">first(DynamicPPL.evaluate!!(model, varinfo_linked, DefaultContext()))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(m = 1.7468437832993746, x = 2.2202653989989214)</code></pre><p>we see that we indeed satisfy the constraint <code>m &lt; x</code>, as desired.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>One shouldn&#39;t be setting variables in a linked <code>varinfo</code> willy-nilly directly like this unless one knows that the value will be compatible with the constraints of the model.</p></div></div><p>The reason for this is that internally in a model evaluation, we construct the transformation from the internal to the model representation based on the <em>current</em> realizations in the model! That is, we take the <code>dist</code> in a <code>x ~ dist</code> expression <em>at model evaluation time</em> and use that to construct the transformation, thus allowing it to change between model evaluations without invalidating the transformation.</p><p>But to be able to do this, we need to know whether the variable is linked / &quot;unconstrained&quot; or not, since the transformation is different in the two cases. Hence we need to be able to determine this at model evaluation time. Hence the internals end up looking something like this:</p><pre><code class="language-julia hljs">if istrans(varinfo, varname)
    from_linked_internal_transform(varinfo, varname, dist)
else
    from_internal_transform(varinfo, varname, dist)
end</code></pre><p>That is, if the variable is linked / &quot;unconstrained&quot;, we use the <a href="#DynamicPPL.from_linked_internal_transform"><code>DynamicPPL.from_linked_internal_transform</code></a>, otherwise we use <a href="#DynamicPPL.from_internal_transform"><code>DynamicPPL.from_internal_transform</code></a>.</p><p>And so the earlier diagram becomes:</p><div class="mermaid">%%{ init: { &#39;flowchart&#39;: { &#39;curve&#39;: &#39;linear&#39; } } }%%
%%{ init: { &#39;themeVariables&#39;: { &#39;lineColor&#39;: &#39;#000000&#39; } } }%%
graph TD
    subgraph assume [&quot;assume&quot;]
        style assume fill:#ffffff,font-family:Courier

        A[&quot;assume(varinfo, &lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;@varname&lt;/span&gt;(x), Normal())&quot;]:::boxStyle
        B([&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;if&lt;/span&gt; istrans(varinfo, varname)&quot;]):::boxStyle
        C[&quot;f = from_internal_transform(varinfo, varname, dist)&quot;]:::boxStyle
        D[&quot;f = from_linked_internal_transform(varinfo, varname, dist)&quot;]:::boxStyle
        E[&quot;x, logjac = with_logabsdet_jacobian(f, assume_internal(varinfo, varname, dist))&quot;]:::boxStyle
        F[&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;return&lt;/span&gt; x, logpdf(dist, x) - logjac, varinfo&quot;]:::dashedBox
        
        A --&gt; B
        B --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;false&lt;/span&gt;| C
        B --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;true&lt;/span&gt;| D
        C --&gt; E
        D --&gt; E
        E --&gt; F
    end

    classDef dashedBox fill:#ffffff,stroke:#000000,stroke-dasharray: 5 5,font-family:Courier,color:#000000
    classDef boxStyle fill:#ffffff,stroke:#000000,font-family:Courier,color:#000000

    linkStyle default stroke:#000000,stroke-width:1px,color:#000000</div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If the support of <code>dist</code> was constant, this would not be necessary since we could just determine the transformation at the time of <code>varinfo_linked = link(varinfo, model)</code> and define this as the <code>from_internal_transform</code> for all subsequent evaluations. However, since the support of <code>dist</code> is <em>not</em> constant in general, we need to be able to determine the transformation at the time of the evaluation <em>and</em> thus whether we should construct the transformation from the linked internal representation or the non-linked internal representation. This is annoying, but necessary.</p></div></div><p>This is also the reason why we have two definitions of <code>getindex</code>:</p><ul><li><a href="../../api/#Base.getindex"><code>getindex(::AbstractVarInfo, ::VarName, ::Distribution)</code></a>: used internally in model evaluations with the <code>dist</code> in a <code>x ~ dist</code> expression.</li><li><a href="../../api/#Base.getindex"><code>getindex(::AbstractVarInfo, ::VarName)</code></a>: used externally by the user to get the realization of a variable.</li></ul><p>For <code>getindex</code> we have the following diagram:</p><div class="mermaid">%%{ init: { &#39;flowchart&#39;: { &#39;curve&#39;: &#39;linear&#39; } } }%%
%%{ init: { &#39;themeVariables&#39;: { &#39;lineColor&#39;: &#39;#000000&#39; } } }%%
graph TD
    subgraph getindex [&quot;getindex&quot;]
        style getindex fill:#ffffff,font-family:Courier

        A[&quot;x = getindex(varinfo, &lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;@varname&lt;/span&gt;(x), Normal())&quot;]:::boxStyle
        B([&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;if&lt;/span&gt; istrans(varinfo, varname)&quot;]):::boxStyle
        C[&quot;f = from_internal_transform(varinfo, varname, dist)&quot;]:::boxStyle
        D[&quot;f = from_linked_internal_transform(varinfo, varname, dist)&quot;]:::boxStyle
        E[&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;return&lt;/span&gt; f(getindex_internal(varinfo, varname))&quot;]:::dashedBox
        
        A --&gt; B
        B --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;false&lt;/span&gt;| C
        B --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;true&lt;/span&gt;| D
        C --&gt; E
        D --&gt; E
    end

    classDef dashedBox fill:#ffffff,stroke:#000000,stroke-dasharray: 5 5,font-family:Courier,color:#000000
    classDef boxStyle fill:#ffffff,stroke:#000000,font-family:Courier,color:#000000

    linkStyle default stroke:#000000,stroke-width:1px,color:#000000</div><p>While if <code>dist</code> is not provided, we have:</p><div class="mermaid">%%{ init: { &#39;flowchart&#39;: { &#39;curve&#39;: &#39;linear&#39; } } }%%
%%{ init: { &#39;themeVariables&#39;: { &#39;lineColor&#39;: &#39;#000000&#39; } } }%%
graph TD
    subgraph getindex [&quot;getindex&quot;]
        style getindex fill:#ffffff,font-family:Courier

        A[&quot;x = getindex(varinfo, &lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;@varname&lt;/span&gt;(x))&quot;]:::boxStyle
        B([&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;if&lt;/span&gt; istrans(varinfo, varname)&quot;]):::boxStyle
        C[&quot;f = from_internal_transform(varinfo, varname)&quot;]:::boxStyle
        D[&quot;f = from_linked_internal_transform(varinfo, varname)&quot;]:::boxStyle
        E[&quot;&lt;span style=&#39;color:#3B6EA8 !important;&#39;&gt;return&lt;/span&gt; f(getindex_internal(varinfo, varname))&quot;]:::dashedBox
        
        A --&gt; B
        B --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;false&lt;/span&gt;| C
        B --&gt;|&lt;span style=&#39;color:#97365B ; background-color:#ffffff;&#39;&gt;true&lt;/span&gt;| D
        C --&gt; E
        D --&gt; E
    end

    classDef dashedBox fill:#ffffff,stroke:#000000,stroke-dasharray: 5 5,font-family:Courier,color:#000000
    classDef boxStyle fill:#ffffff,stroke:#000000,font-family:Courier,color:#000000

    linkStyle default stroke:#000000,stroke-width:1px,color:#000000</div><p>Notice that <code>dist</code> is not present here, but otherwise the diagrams are the same.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This does mean that the <code>getindex(varinfo, varname)</code> might not be the same as the <code>getindex(varinfo, varname, dist)</code> that occurs within a model evaluation! This can be confusing, but as outlined above, we do want to allow the <code>dist</code> in a <code>x ~ dist</code> expression to &quot;override&quot; whatever transformation <code>varinfo</code> might have.</p></div></div><h2 id="Other-functionalities"><a class="docs-heading-anchor" href="#Other-functionalities">Other functionalities</a><a id="Other-functionalities-1"></a><a class="docs-heading-anchor-permalink" href="#Other-functionalities" title="Permalink"></a></h2><p>There are also some additional methods for transforming between representations that are all automatically implemented from <a href="#DynamicPPL.from_internal_transform"><code>DynamicPPL.from_internal_transform</code></a>, <a href="#DynamicPPL.from_linked_internal_transform"><code>DynamicPPL.from_linked_internal_transform</code></a> and their siblings, and thus don&#39;t need to be implemented manually.</p><p>Convenience methods for constructing transformations:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.from_maybe_linked_internal_transform" href="#DynamicPPL.from_maybe_linked_internal_transform"><code>DynamicPPL.from_maybe_linked_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">from_maybe_linked_internal_transform(varinfo::AbstractVarInfo, vn::VarName[, dist])</code></pre><p>Return a transformation that transforms from the possibly linked internal representation of <code>vn</code> with <code>dist</code>n in <code>varinfo</code> to a representation compatible with <code>dist</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L819-L826">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.to_maybe_linked_internal_transform" href="#DynamicPPL.to_maybe_linked_internal_transform"><code>DynamicPPL.to_maybe_linked_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">to_maybe_linked_internal_transform(varinfo::AbstractVarInfo, vn::VarName[, dist])</code></pre><p>Return a transformation that transforms from a representation compatible with <code>dist</code> to a possibly linked internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L872-L879">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.internal_to_linked_internal_transform" href="#DynamicPPL.internal_to_linked_internal_transform"><code>DynamicPPL.internal_to_linked_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">internal_to_linked_internal_transform(varinfo::AbstractVarInfo, vn::VarName, dist)</code></pre><p>Return a transformation that transforms from the internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code> to a <em>linked</em> internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L887-L894">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.linked_internal_to_internal_transform" href="#DynamicPPL.linked_internal_to_internal_transform"><code>DynamicPPL.linked_internal_to_internal_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linked_internal_to_internal_transform(varinfo::AbstractVarInfo, vn::VarName[, dist])</code></pre><p>Return a transformation that transforms from a <em>linked</em> internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code> to the internal representation of <code>vn</code> with <code>dist</code> in <code>varinfo</code>.</p><p>If <code>dist</code> is not present, then it is assumed that <code>varinfo</code> knows the correct output for <code>vn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L906-L913">source</a></section></article><p>Convenience methods for transforming between representations without having to explicitly construct the transformation:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.to_maybe_linked_internal" href="#DynamicPPL.to_maybe_linked_internal"><code>DynamicPPL.to_maybe_linked_internal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">to_maybe_linked_internal(vi::AbstractVarInfo, vn::VarName, dist, val)</code></pre><p>Return reconstructed <code>val</code>, possibly linked if <code>istrans(vi, vn)</code> is <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L753-L757">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.from_maybe_linked_internal" href="#DynamicPPL.from_maybe_linked_internal"><code>DynamicPPL.from_maybe_linked_internal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">from_maybe_linked_internal(vi::AbstractVarInfo, vn::VarName, dist, val)</code></pre><p>Return reconstructed <code>val</code>, possibly invlinked if <code>istrans(vi, vn)</code> is <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/abstract_varinfo.jl#L763-L767">source</a></section></article><h1 id="Supporting-a-new-distribution"><a class="docs-heading-anchor" href="#Supporting-a-new-distribution">Supporting a new distribution</a><a id="Supporting-a-new-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Supporting-a-new-distribution" title="Permalink"></a></h1><p>To support a new distribution, one needs to implement for the desired <code>AbstractVarInfo</code> the following methods:</p><ul><li><a href="#DynamicPPL.from_internal_transform"><code>DynamicPPL.from_internal_transform</code></a></li><li><a href="#DynamicPPL.from_linked_internal_transform"><code>DynamicPPL.from_linked_internal_transform</code></a></li></ul><p>At the time of writing, <a href="../../api/#VarInfo"><code>VarInfo</code></a> is the one that is most commonly used, whose internal representation is always a <code>Vector</code>. In this scenario, one can just implement the following methods instead:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.from_vec_transform-Tuple{Distribution}" href="#DynamicPPL.from_vec_transform-Tuple{Distribution}"><code>DynamicPPL.from_vec_transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">from_vec_transform(dist::Distribution)</code></pre><p>Return the transformation from the vector representation of a realization from distribution <code>dist</code> to the original representation compatible with <code>dist</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/utils.jl#L344-L349">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.from_linked_vec_transform-Tuple{Distribution}" href="#DynamicPPL.from_linked_vec_transform-Tuple{Distribution}"><code>DynamicPPL.from_linked_vec_transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">from_linked_vec_transform(dist::Distribution)</code></pre><p>Return the transformation from the unconstrained vector to the constrained realization of distribution <code>dist</code>.</p><p>By default, this is just <code>invlink_transform(dist) ∘ from_vec_transform(dist)</code>.</p><p>See also: <a href="../../api/#DynamicPPL.invlink_transform"><code>DynamicPPL.invlink_transform</code></a>, <a href="#DynamicPPL.from_vec_transform-Tuple{Distribution}"><code>DynamicPPL.from_vec_transform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/utils.jl#L364-L373">source</a></section></article><p>These are used internally by <a href="../../api/#VarInfo"><code>VarInfo</code></a>.</p><p>Optionally, if <code>inverse</code> of the above is expensive to compute, one can also implement:</p><ul><li><a href="#DynamicPPL.to_internal_transform"><code>DynamicPPL.to_internal_transform</code></a></li><li><a href="#DynamicPPL.to_linked_internal_transform"><code>DynamicPPL.to_linked_internal_transform</code></a></li></ul><p>And similarly, there are corresponding to-methods for the <code>from_*_vec_transform</code> variants too</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.to_vec_transform" href="#DynamicPPL.to_vec_transform"><code>DynamicPPL.to_vec_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">to_vec_transform(x)</code></pre><p>Return the transformation from the original representation of <code>x</code> to the vector representation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/utils.jl#L399-L404">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicPPL.to_linked_vec_transform" href="#DynamicPPL.to_linked_vec_transform"><code>DynamicPPL.to_linked_vec_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">to_linked_vec_transform(dist)</code></pre><p>Return the transformation from the constrained realization of distribution <code>dist</code> to the unconstrained vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/DynamicPPL.jl/blob/09e997b7a45d2496f462385e2075fd09fb238193/src/utils.jl#L407-L412">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Whatever the resulting transformation is, it should be invertible, i.e. implement <code>InverseFunctions.inverse</code>, and have a well-defined log-abs-det Jacobian, i.e. implement <code>ChangesOfVariables.with_logabsdet_jacobian</code>.</p></div></div><h1 id="TL;DR"><a class="docs-heading-anchor" href="#TL;DR">TL;DR</a><a id="TL;DR-1"></a><a class="docs-heading-anchor-permalink" href="#TL;DR" title="Permalink"></a></h1><ul><li><p>DynamicPPL.jl has three representations of a variable: the <strong>model representation</strong>, the <strong>internal representation</strong>, and the <strong>linked internal representation</strong>.</p><ul><li>The <strong>model representation</strong> is the representation of the variable as it appears in the model code / is expected by the <code>dist</code> on the right-hand-side of the <code>~</code> in the model code.</li><li>The <strong>internal representation</strong> is the representation of the variable as it appears in the <code>varinfo</code>, which varies between implementations of <a href="../../api/#DynamicPPL.AbstractVarInfo"><code>AbstractVarInfo</code></a>, e.g. a <code>Vector</code> in <a href="../../api/#VarInfo"><code>VarInfo</code></a>. This can be converted to the model representation by <a href="#DynamicPPL.from_internal_transform"><code>DynamicPPL.from_internal_transform</code></a>.</li><li>The <strong>linked internal representation</strong> is the representation of the variable as it appears in the <code>varinfo</code> after <a href="../../api/#Bijectors.link"><code>link</code></a>ing. This can be converted to the model representation by <a href="#DynamicPPL.from_linked_internal_transform"><code>DynamicPPL.from_linked_internal_transform</code></a>.</li></ul></li><li><p>Having separation between <em>internal</em> and <em>linked internal</em> is necessary because transformations might be constructed at the time of model evaluation, and thus we need to know whether to construct the transformation from the internal representation or the linked internal representation.</p></li></ul><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../varinfo/">« Design of <code>VarInfo</code></a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 7 November 2024 12:18">Thursday 7 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

