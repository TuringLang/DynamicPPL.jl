<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transform strategies · DynamicPPL</title><meta name="title" content="Transform strategies · DynamicPPL"/><meta property="og:title" content="Transform strategies · DynamicPPL"/><meta property="twitter:title" content="Transform strategies · DynamicPPL"/><meta name="description" content="Documentation for DynamicPPL."/><meta property="og:description" content="Documentation for DynamicPPL."/><meta property="twitter:description" content="Documentation for DynamicPPL."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body>
<!-- NAVBAR START -->
<style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap');

    /* Documenter.jl CSS Overrides */
    html {
        scroll-padding-top: calc(var(--navbar-height) + 1rem);
    }
    .docs-sidebar, #documenter {
        margin-top: var(--navbar-height);
    }
    .docs-version-selector {
        margin-bottom: 60px !important;
    }
    @media screen and (max-width: 1056px) {
        .docs-version-selector {
            margin-bottom: 60px !important;
        }
        .docs-sidebar {
            margin-top: 0 !important;
        }
    }
    /* End of Documenter.jl Tweaks */

    /* Color and Font Variables */
    :root {
        --heading-color: #6c757d;
        --item-color: rgb(165, 165, 165);
        --primary-bg: white;
        --hover-color: #8faad2;
        --deprecated-bg: #ff4d4d;
        --deprecated-text: white;
        --icon-color: #6c757d;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e9ecef;
        
        /* Typography */
        --font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        --nav-link-font-size: 1.0625rem;
        --turing-title-font-size: 21.25px;
        --icon-font-size: 1.25rem;
        --dropdown-arrow-font-size: 0.6875rem;
        --badge-font-size: 0.75rem;

        /* Sizing and Spacing */
        --navbar-height: 3.75rem;
        --logo-height: 31px;
        --logo-width: auto;
        --logo-padding-top: 7px;
        --logo-margin-left: 0.8rem;
        --title-margin-left: 0.4px;
        --title-nav-spacing: 1.1rem;
        --nav-item-margin-left: 1.3rem;
        --icon-margin-left: 1rem;
        --dropdown-padding: 1.875rem;
        --dropdown-item-width: 12.5rem;
        --dropdown-subitem-width: 15.625rem;
        --dropdown-subitem-padding: 0.125rem 0.625rem;
    }

    /* Dark Theme Variable Overrides */
    html.theme--documenter-dark {
        --heading-color: #e0e0e0;
        --item-color: #bdbdbd;
        --primary-bg: #1f2424;
        --hover-color: #ffffff;
        --icon-color: #e0e0e0;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #424242;
    }

    /* Catppuccin Theme Overrides */
    html.theme--catppuccin-latte {
        --heading-color: #4c4f69;
        --primary-bg: #eff1f5;
        --icon-color: #4c4f69;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --dropdown-hover-bg: #e6e9ef;
    }
    html.theme--catppuccin-frappe {
        --heading-color: #c6d0f5;
        --primary-bg: #303446;
        --icon-color: #c6d0f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #51576d;
    }
    html.theme--catppuccin-macchiato {
        --heading-color: #cad3f5;
        --primary-bg: #24273a;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #494d64;
    }
    html.theme--catppuccin-mocha {
        --heading-color: #cad3f5;
        --primary-bg: #1e1e2e;
        --icon-color: #cad3f5;
        --shadow-color: rgba(255, 255, 255, 0.1);
        --dropdown-hover-bg: #45475a;
    }


    /* Main Navigation Bar */
    .ext-navigation {
        font-family: var(--font-family);
        position: fixed;
        height: var(--navbar-height);
        top: 0;
        width: 100%;
        background-color: var(--primary-bg);
        z-index: 1000;
        box-shadow: 0 2px 4px var(--shadow-color);
        display: flex;
        align-items: center;
        padding: 0 1.0625rem;
        transition: transform 0.3s, background-color 0.3s;
    }

    nav.ext-navigation .ext-navbar-logo {
        margin-left: var(--logo-margin-left);
        height: auto;
        max-height: var(--logo-height);
        width: auto;
        padding-top: var(--logo-padding-top);
    }
    
    /* Theme-aware logo text color */
    .ext-navbar-logo .logo-text {
        fill: var(--heading-color);
    }
    
    .ext-navbar-title {
        color: var(--heading-color) !important;
        font-size: var(--turing-title-font-size) !important;
        margin-left: var(--title-margin-left);
        text-decoration: none;
        transition: color 0.2s ease;
    }
    
    .ext-navbar-title:hover {
        color: var(--hover-color) !important;
    }

    .ext-nav-links {
        display: flex;
        align-items: center;
        list-style-type: none;
        margin: 0;
        padding: 0;
        flex-grow: 1;
        margin-left: var(--title-nav-spacing);
    }

    .ext-nav-links li:first-child {
        margin-left: 0 !important;
    }

    .ext-nav-links li {
        margin-left: var(--nav-item-margin-left) !important;
    }

    .ext-nav-link {
        color: var(--heading-color) !important;
        text-decoration: none;
        font-size: var(--nav-link-font-size) !important;
        transition: color 0.2s ease;
        cursor: pointer;
    }

    .ext-nav-link:hover,
    .ext-navbar-item-single a:hover,
    .ext-navbar-icons a:hover {
        color: var(--hover-color) !important;
    }

    .ext-navbar-item-single a {
        color: var(--heading-color) !important;
    }
    
    .ext-navbar-icons {
        display: flex;
        align-items: center;
    }

    .ext-navbar-icons a {
        color: var(--icon-color) !important;
        font-size: var(--icon-font-size) !important;
        transition: color 0.2s ease;
        margin-left: var(--icon-margin-left);
    }

    .ext-menu-toggle {
        display: none;
        font-size: 1.5rem;
        color: var(--heading-color);
        cursor: pointer;
    }

    .ext-dropdown {
        display: none;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        padding: var(--dropdown-padding);
        position: absolute;
        top: var(--navbar-height);
        width: 100%;
        left: 0;
        background-color: var(--primary-bg);
        line-height: 1.875rem;
        opacity: 0;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, background-color 0.3s;
        transform: translateY(-0.625rem);
        box-shadow: 0 4px 6px var(--shadow-color);
    }

    #library-handler::after {
        content: "▼";
        font-size: var(--dropdown-arrow-font-size);
        margin-left: 0.3125rem;
        transition: transform 0.3s ease-in-out;
    }

    #library-handler.open::after {
        content: "▲";
    }

    .ext-dropdown.show {
        display: grid;
        opacity: 1;
        transform: translateY(0);
    }

    .ext-dropdown ul {
        width: var(--dropdown-item-width);
        margin-bottom: 1.25rem;
    }

    .ext-dropdown ul li {
        text-align: left;
        display: flex;
        align-items: center;
    }

    .ext-dropdown ul a li {
        color: var(--item-color);
        width: var(--dropdown-subitem-width);
        border-radius: 3px;
        padding: var(--dropdown-subitem-padding);
        transition: background-color 0.2s ease;
    }

    .ext-dropdown ul a li:hover {
        background-color: var(--dropdown-hover-bg);
    }

    .ext-dropdown-item-heading {
        color: var(--heading-color);
        text-align: center;
    }

    .deprecated-badge {
        background-color: var(--deprecated-bg);
        color: var(--deprecated-text);
        font-size: var(--badge-font-size);
        padding: .1rem;
        border-radius: 3px;
        margin-left: 0.5rem;
        line-height: 1;
    }

    @media (max-width: 966px) {
        .ext-dropdown {
            grid-template-columns: 1fr 1fr 1fr;
        }
    }

    @media (max-width: 768px) {
        .ext-nav-links {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            background-color: var(--primary-bg);
            position: absolute;
            top: var(--navbar-height);
            left: 0;
            padding: 0.625rem 0;
            height: auto;
            overflow-y: auto;
            box-shadow: 0 4px 6px var(--shadow-color);
            margin-left: 0;
        }

        .ext-nav-links.show {
            display: flex;
        }

        .ext-nav-links li {
            margin: 0.625rem 0 !important;
            text-align: center;
        }
        
        .ext-menu-toggle {
            display: block;
            margin-left: auto;
        }

        .ext-navigation.hide {
            transform: translateY(calc(-1 * var(--navbar-height)));
        }

        .ext-dropdown {
            position: static;
            display: block;
            opacity: 1;
            transform: none;
            box-shadow: none;
            grid-template-columns: 1fr;
            padding: 0.625rem;
            text-align: center;
        }

        .ext-dropdown ul {
            width: auto;
            display: inline-block;
            margin: 0 auto 0.3125rem;
            text-align: left;
        }
    }
</style>
<nav class="ext-navigation">
    <a href="https://turinglang.org/">
        <svg width="4333" height="1145" viewBox="0 0 4333 1145" fill="none" xmlns="http://www.w3.org/2000/svg" class="ext-navbar-logo">
            <path class="logo-text" d="M0.44603 193.181V66.9868H663.471V193.181H406.62V898H257.297V193.181H0.44603ZM1097.24 635.874V274.74H1244.13V898H1101.7V787.225H1095.21C1081.14 822.121 1058.01 850.66 1025.82 872.842C993.902 895.024 954.542 906.115 907.744 906.115C866.896 906.115 830.783 897.053 799.403 878.929C768.295 860.534 743.948 833.889 726.365 798.993C708.782 763.826 699.99 721.356 699.99 671.581V274.74H846.878V648.858C846.878 688.353 857.699 719.733 879.34 742.997C900.981 766.261 929.385 777.893 964.551 777.893C986.192 777.893 1007.16 772.618 1027.45 762.068C1047.73 751.518 1064.37 735.828 1077.35 714.999C1090.61 693.899 1097.24 667.524 1097.24 635.874ZM1395.17 898V274.74H1537.6V378.617H1544.09C1555.45 342.639 1574.93 314.911 1602.52 295.434C1630.38 275.687 1662.17 265.813 1697.88 265.813C1705.99 265.813 1715.05 266.219 1725.06 267.031C1735.34 267.572 1743.86 268.518 1750.63 269.871V404.992C1744.4 402.828 1734.53 400.934 1721 399.311C1707.75 397.417 1694.9 396.471 1682.46 396.471C1655.68 396.471 1631.6 402.287 1610.23 413.919C1589.13 425.28 1572.49 441.105 1560.32 461.393C1548.15 481.682 1542.06 505.081 1542.06 531.591V898H1395.17ZM1848.21 898V274.74H1995.1V898H1848.21ZM1922.06 186.283C1898.8 186.283 1878.78 178.573 1862.01 163.154C1845.24 147.464 1836.85 128.664 1836.85 106.752C1836.85 84.5701 1845.24 65.7695 1862.01 50.3503C1878.78 34.6606 1898.8 26.8158 1922.06 26.8158C1945.6 26.8158 1965.61 34.6606 1982.12 50.3503C1998.89 65.7695 2007.27 84.5701 2007.27 106.752C2007.27 128.664 1998.89 147.464 1982.12 163.154C1965.61 178.573 1945.6 186.283 1922.06 186.283ZM2293.04 532.809V898H2146.15V274.74H2286.54V380.646H2293.85C2308.18 345.75 2331.04 318.022 2362.42 297.463C2394.07 276.904 2433.16 266.625 2479.69 266.625C2522.7 266.625 2560.17 275.822 2592.09 294.217C2624.28 312.612 2649.17 339.257 2666.75 374.153C2684.6 409.049 2693.39 451.385 2693.12 501.159V898H2546.24V523.882C2546.24 482.223 2535.41 449.626 2513.77 426.092C2492.4 402.557 2462.78 390.79 2424.91 390.79C2399.21 390.79 2376.35 396.471 2356.34 407.832C2336.59 418.923 2321.03 435.019 2309.67 456.119C2298.58 477.218 2293.04 502.782 2293.04 532.809ZM3113.5 1144.71C3060.75 1144.71 3015.44 1137.54 2977.57 1123.2C2939.7 1109.13 2909.26 1090.2 2886.27 1066.39C2863.28 1042.59 2847.32 1016.21 2838.39 987.269L2970.67 955.213C2976.62 967.386 2985.28 979.424 2996.64 991.327C3008 1003.5 3023.28 1013.51 3042.49 1021.35C3061.97 1029.47 3086.45 1033.53 3115.93 1033.53C3157.59 1033.53 3192.08 1023.38 3219.4 1003.09C3246.73 983.076 3260.39 950.074 3260.39 904.087V786.008H3253.08C3245.51 801.157 3234.42 816.711 3219.81 832.671C3205.47 848.632 3186.4 862.022 3162.6 872.842C3139.06 883.663 3109.44 889.073 3073.73 889.073C3025.85 889.073 2982.44 877.847 2943.48 855.394C2904.8 832.671 2873.96 798.857 2850.97 753.952C2828.24 708.777 2816.88 652.24 2816.88 584.341C2816.88 515.902 2828.24 458.147 2850.97 411.078C2873.96 363.739 2904.93 327.896 2943.89 303.55C2982.84 278.933 3026.26 266.625 3074.14 266.625C3110.66 266.625 3140.69 272.847 3164.22 285.29C3188.03 297.463 3206.96 312.206 3221.03 329.519C3235.09 346.561 3245.78 362.657 3253.08 377.805H3261.2V274.74H3406.06V908.144C3406.06 961.435 3393.34 1005.53 3367.92 1040.42C3342.49 1075.32 3307.73 1101.43 3263.63 1118.74C3219.54 1136.05 3169.5 1144.71 3113.5 1144.71ZM3114.72 773.835C3145.83 773.835 3172.34 766.261 3194.25 751.112C3216.16 735.963 3232.79 714.187 3244.16 685.783C3255.52 657.379 3261.2 623.295 3261.2 583.53C3261.2 544.305 3255.52 509.95 3244.16 480.465C3233.07 450.979 3216.56 428.12 3194.65 411.89C3173.01 395.389 3146.37 387.138 3114.72 387.138C3081.98 387.138 3054.66 395.659 3032.75 412.701C3010.84 429.744 2994.34 453.143 2983.25 482.899C2972.16 512.385 2966.61 545.929 2966.61 583.53C2966.61 621.672 2972.16 655.08 2983.25 683.754C2994.61 712.158 3011.25 734.34 3033.16 750.3C3055.34 765.99 3082.53 773.835 3114.72 773.835ZM3647.08 906.927C3622.47 906.927 3601.37 898.271 3583.78 880.958C3566.2 863.645 3557.54 842.545 3557.82 817.658C3557.54 793.312 3566.2 772.482 3583.78 755.17C3601.37 737.857 3622.47 729.2 3647.08 729.2C3670.89 729.2 3691.58 737.857 3709.17 755.17C3727.02 772.482 3736.08 793.312 3736.35 817.658C3736.08 834.159 3731.75 849.173 3723.37 862.698C3715.25 876.224 3704.43 887.044 3690.91 895.16C3677.65 903.004 3663.04 906.927 3647.08 906.927ZM3888.01 274.74H4034.9V933.708C4034.9 978.613 4026.38 1015.67 4009.33 1044.89C3992.29 1074.1 3967.67 1095.88 3935.48 1110.22C3903.29 1124.55 3864.2 1131.72 3818.22 1131.72C3812.81 1131.72 3807.8 1131.59 3803.2 1131.32C3798.6 1131.32 3793.6 1131.18 3788.19 1130.91V1011.21C3792.25 1011.48 3795.9 1011.62 3799.15 1011.62C3802.39 1011.89 3805.77 1012.02 3809.29 1012.02C3837.42 1012.02 3857.58 1005.12 3869.75 991.327C3881.92 977.801 3888.01 957.918 3888.01 931.679V274.74ZM3961.05 186.283C3937.51 186.283 3917.36 178.573 3900.59 163.154C3884.09 147.464 3875.84 128.664 3875.84 106.752C3875.84 84.5701 3884.09 65.7695 3900.59 50.3503C3917.36 34.6606 3937.51 26.8158 3961.05 26.8158C3984.31 26.8158 4004.19 34.6606 4020.7 50.3503C4037.47 65.7695 4045.85 84.5701 4045.85 106.752C4045.85 128.664 4037.47 147.464 4020.7 163.154C4004.19 178.573 3984.31 186.283 3961.05 186.283ZM4332.83 66.9868V898H4185.94V66.9868H4332.83Z" fill="currentColor"/>
            <path d="M4076 108.5C4076 168.424 4027.42 217 3967.5 217C3907.58 217 3859 168.424 3859 108.5C3859 48.5762 3907.58 0 3967.5 0C4027.42 0 4076 48.5762 4076 108.5Z" fill="#389725"/>
            <path d="M3755 814.5C3755 874.424 3706.42 923 3646.5 923C3586.58 923 3538 874.424 3538 814.5C3538 754.576 3586.58 706 3646.5 706C3706.42 706 3755 754.576 3755 814.5Z" fill="#9457B1"/>
            <path d="M2030 108.5C2030 168.424 1981.42 217 1921.5 217C1861.58 217 1813 168.424 1813 108.5C1813 48.5762 1861.58 0 1921.5 0C1981.42 0 2030 48.5762 2030 108.5Z" fill="#CA3B33"/>
        </svg>
    </a>
    <!-- <a class="ext-navbar-title" href="https://turinglang.org/">Turing.jl</a> -->
    
    <ul class="ext-nav-links">
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/getting-started/">Get Started</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/tutorials/">Tutorials</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/docs/faq/">FAQ</a></li>
        <li>
            <p class="ext-nav-link" id="library-handler">Libraries</p>
            <div class="ext-dropdown" id="ext-dropdown-items">
                <ul>
                    <li class="ext-dropdown-item-heading">Modelling Languages</li>
                    <a href="https://turinglang.org/DynamicPPL.jl/"><li>DynamicPPL</li></a>
                    <a href="https://turinglang.org/JuliaBUGS.jl/"><li>JuliaBUGS</li></a>
                    <a href="https://turinglang.org/TuringGLM.jl/"><li>TuringGLM</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">MCMC</li>
                    <a href="https://turinglang.org/AdvancedHMC.jl/"><li>AdvancedHMC</li></a>
                    <a href="https://turinglang.org/AbstractMCMC.jl/"><li>AbstractMCMC</li></a>
                    <a href="https://github.com/theogf/ThermodynamicIntegration.jl"><li>ThermodynamicIntegration</li></a>
                    <a href="https://turinglang.org/AdvancedPS.jl/"><li>AdvancedPS</li></a>
                    <a href="https://turinglang.org/SliceSampling.jl/"><li>SliceSampling</li></a>
                    <a href="https://turinglang.org/EllipticalSliceSampling.jl/"><li>EllipticalSliceSampling</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Diagnostics</li>
                    <a href="https://turinglang.org/MCMCChains.jl/"><li>MCMCChains</li></a>
                    <a href="https://turinglang.org/MCMCDiagnosticTools.jl/"><li>MCMCDiagnosticTools</li></a>
                    <a href="https://chalk-lab.github.io/ParetoSmooth.jl/"><li>ParetoSmooth</li></a>
                </ul>
                <ul>
                    <li class="ext-dropdown-item-heading">Gaussian Processes</li>
                    <a href="https://juliagaussianprocesses.github.io/AbstractGPs.jl/"><li>AbstractGPs</li></a>
                    <a href="https://juliagaussianprocesses.github.io/KernelFunctions.jl/"><li>KernelFunctions</li></a>
                    <a href="https://juliagaussianprocesses.github.io/ApproximateGPs.jl/"><li>ApproximateGPs</li></a>
                </ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Bijectors.jl/">Bijectors</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/TuringCallbacks.jl/">TuringCallbacks</a></li></ul>
                <ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Deprecated/TuringBenchmarking/">TuringBenchmarking</a><span class="deprecated-badge">Deprecated</span></li></ul>
            </div>
        </li>
        <li><a class="ext-nav-link" href="https://turinglang.org/news/">News</a></li>
        <li><a class="ext-nav-link" href="https://turinglang.org/team/">Team</a></li>
    </ul>

    <div class="ext-navbar-icons">
        <a href="https://x.com/TuringLang" aria-label="Turing on X"><i class="fa-brands fa-x-twitter"></i></a>
        <a href="https://discourse.julialang.org/c/domain/probprog/48" aria-label="Turing on Discourse"><i class="fa-brands fa-discourse"></i></a>
        <a href="https://julialang.slack.com/archives/CCYDC34A0" aria-label="Turing on Slack"><i class="fa-brands fa-slack"></i></a>
        <a href="https://github.com/TuringLang/" aria-label="Turing.jl on GitHub"><i class="fa-brands fa-github"></i></a>
    </div>

    <span class="ext-menu-toggle"><i class="fa-solid fa-bars"></i></span>
</nav>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".ext-menu-toggle");
        const navLinks = document.querySelector(".ext-nav-links");
        const nav = document.querySelector(".ext-navigation");
        const libraryHandler = document.getElementById("library-handler");
        const dropdownContainer = document.getElementById("ext-dropdown-items");
        let lastScrollY = window.scrollY;

        function closeDropdown() {
            if (dropdownContainer.classList.contains("show")) {
                libraryHandler.classList.remove("open");
                dropdownContainer.classList.remove("show");
                setTimeout(() => {
                    if (!dropdownContainer.classList.contains("show")) {
                        dropdownContainer.style.display = "none";
                    }
                }, 300);
            }
        }

        function openDropdown() {
            dropdownContainer.style.display = "grid";
            libraryHandler.classList.add("open");
            setTimeout(() => {
                dropdownContainer.classList.add("show");
            }, 10);
        }

        function setAppropriateHeight() {
            if (window.innerWidth <= 768) {
                const viewportHeight = window.innerHeight;
                const navHeight = nav.offsetHeight;
                navLinks.style.maxHeight = `${viewportHeight - navHeight}px`;
                navLinks.style.overflowY = "auto";
            } else {
                navLinks.style.maxHeight = "";
                navLinks.style.overflowY = "";
            }
        }

        menuToggle.addEventListener("click", (event) => {
            event.stopPropagation();
            navLinks.classList.toggle("show");
            if (navLinks.classList.contains("show")) {
                setAppropriateHeight();
                closeDropdown();
                dropdownContainer.style.display = "none";
            }
        });

        libraryHandler.addEventListener("click", (event) => {
            event.stopPropagation();
            event.preventDefault();
            if (dropdownContainer.classList.contains("show")) {
                closeDropdown();
            } else {
                openDropdown();
            }
            setAppropriateHeight();
        });

        // Close all menus if a click is registered outside the navigation bar.
        document.addEventListener("click", (event) => {
            if (!nav.contains(event.target)) {
                navLinks.classList.remove("show");
                closeDropdown();
            }
        });

        // Hide navigation bar on scroll down in mobile view.
        window.addEventListener("scroll", () => {
            if (window.innerWidth <= 768) {
                if (window.scrollY > lastScrollY && window.scrollY > nav.offsetHeight){
                    nav.classList.add("hide");
                } else {
                    nav.classList.remove("hide");
                }
                lastScrollY = window.scrollY;
            }
        });

        window.addEventListener("resize", setAppropriateHeight);
    });
</script>
<!-- NAVBAR END -->



<div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DynamicPPL logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicPPL</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../conditionfix/">Conditioning and fixing</a></li><li><span class="tocitem">VarNamedTuple</span><ul><li><a class="tocitem" href="../vnt/motivation/">Motivation</a></li><li><a class="tocitem" href="../vnt/design/">Design</a></li><li><a class="tocitem" href="../vnt/implementation/">Implementation</a></li><li><a class="tocitem" href="../vnt/arraylikeblocks/">Array-like blocks</a></li></ul></li><li><a class="tocitem" href="../evaluation/">Model evaluation</a></li><li><a class="tocitem" href="../tilde/">Tilde-statements</a></li><li><a class="tocitem" href="../init/">Initialisation strategies</a></li><li class="is-active"><a class="tocitem" href>Transform strategies</a><ul class="internal"><li><a class="tocitem" href="#AbstractTransformStrategy"><span><code>AbstractTransformStrategy</code></span></a></li><li><a class="tocitem" href="#Making-your-own-transform-strategy"><span>Making your own transform strategy</span></a></li><li><a class="tocitem" href="#DynamicLink-in-more-detail"><span><code>DynamicLink</code> in more detail</span></a></li><li><a class="tocitem" href="#Fixed-transformations"><span>Fixed transformations</span></a></li><li><a class="tocitem" href="#Why-not-let-init()-determine-the-transform?"><span>Why not let <code>init()</code> determine the transform?</span></a></li></ul></li><li><span class="tocitem">Accumulators</span><ul><li><a class="tocitem" href="../accs/overview/">Overview</a></li><li><a class="tocitem" href="../accs/existing/">Existing accumulators in DynamicPPL</a></li><li><a class="tocitem" href="../accs/threadsafe/">Thread-safe accumulation</a></li><li><a class="tocitem" href="../accs/values/">Storing vectorised vs. raw values</a></li></ul></li><li><span class="tocitem">LogDensityFunction</span><ul><li><a class="tocitem" href="../ldf/overview/">Overview</a></li><li><a class="tocitem" href="../ldf/models/">Using LDFs in model evaluation</a></li></ul></li><li><a class="tocitem" href="../migration/">Migrating old VarInfo code</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Transform strategies</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transform strategies</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TuringLang/DynamicPPL.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/TuringLang/DynamicPPL.jl/blob/main/docs/src/transforms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="transform-strategies"><a class="docs-heading-anchor" href="#transform-strategies">Transform strategies</a><a id="transform-strategies-1"></a><a class="docs-heading-anchor-permalink" href="#transform-strategies" title="Permalink"></a></h1><p>Often it is useful to evaluate the log-probability of a model in a different space to the original one that it is defined in.</p><div class="admonition is-info" id="Note-2d6a41a84541f334"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-2d6a41a84541f334" title="Permalink"></a></header><div class="admonition-body"><p>The <a href="https://turinglang.org/docs/developers/transforms/distributions/">main Turing documentation site</a> has a more detailed introduction to variable transformations in MCMC sampling. This page only describes the implementation in DynamicPPL.</p></div></div><p>Consider the following model:</p><pre><code class="language-julia hljs">using DynamicPPL, Distributions

@model function f()
    x ~ LogNormal()
    y ~ LogNormal()
    return (x, y)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">f (generic function with 2 methods)</code></pre><p>There are several ways in which we might want to evaluate this model:</p><ul><li><p><strong>In the original (&#39;untransformed&#39;) space:</strong> we provide values for <code>x</code> and <code>y</code> which are both positive, and we evaluate the log-probability directly. This corresponds directly to</p><pre><code class="language-julia hljs">x, y = 1.5, 2.0
logp = logpdf(LogNormal(), x) + logpdf(LogNormal(), y)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-3.2589168389831387</code></pre></li><li><p><strong>In unconstrained (&#39;transformed&#39;) space</strong>: we provide values for <code>x</code> and <code>y</code> in unconstrained space (i.e. they are real numbers), and evaluate the log-probability in transformed space. This corresponds to something like:</p><pre><code class="language-julia hljs">x, y = 1.5, 2.0

# To calculate the correct log-probability, we need to transform back to the
# original space, but also account for the log-absolute-determinant of the
# transformation Jacobian.
trf_x, trf_y = log(x), log(y)
logdetJx = -trf_x
logdetJy = -trf_y

logp = logpdf(LogNormal(), x) + logpdf(LogNormal(), y) - logdetJx - logdetJy</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-2.160304550315029</code></pre></li><li><p>We might also want to have <strong>a mix of transformed and untransformed variables</strong>, for example, <code>x</code> in untransformed space and <code>y</code> in transformed space. This could be useful for example when using Gibbs sampling, or Metropolis–Hastings with different proposal distributions for different variables.</p></li></ul><h2 id="AbstractTransformStrategy"><a class="docs-heading-anchor" href="#AbstractTransformStrategy"><code>AbstractTransformStrategy</code></a><a id="AbstractTransformStrategy-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractTransformStrategy" title="Permalink"></a></h2><p>DynamicPPL allows you to specify which variables you want to evaluate in transformed space using <strong>transform strategies</strong>. All transform strategies are subtypes of <code>AbstractTransformStrategy</code>. Currently, DynamicPPL provides the transform strategies <a href="../api/#DynamicPPL.LinkAll"><code>LinkAll</code></a>, <a href="../api/#DynamicPPL.UnlinkAll"><code>UnlinkAll</code></a>, <a href="../api/#DynamicPPL.LinkSome"><code>LinkSome</code></a>, and <a href="../api/#DynamicPPL.UnlinkSome"><code>UnlinkSome</code></a>. Their meanings should be fairly self-explanatory; here is a brief demonstration:</p><pre><code class="language-julia hljs">params = @vnt begin
    x := 1.5
    y := 2.0
end
_, vi_unlinked = init!!(f(), OnlyAccsVarInfo(), InitFromParams(params), UnlinkAll())
vi_unlinked.accs</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AccumulatorTuple with 3 accumulators
├─ <span class="sgr36">LogPrior</span> =&gt; LogPriorAccumulator(-3.2589168389831387)
├─ <span class="sgr36">LogJacobian</span> =&gt; LogJacobianAccumulator(0.0)
└─ <span class="sgr36">LogLikelihood</span> =&gt; LogLikelihoodAccumulator(0.0)</code></pre><pre><code class="language-julia hljs">_, vi_linked = init!!(f(), OnlyAccsVarInfo(), InitFromParams(params), LinkAll())
vi_linked.accs</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AccumulatorTuple with 3 accumulators
├─ <span class="sgr36">LogPrior</span> =&gt; LogPriorAccumulator(-3.2589168389831387)
├─ <span class="sgr36">LogJacobian</span> =&gt; LogJacobianAccumulator(-1.0986122886681096)
└─ <span class="sgr36">LogLikelihood</span> =&gt; LogLikelihoodAccumulator(0.0)</code></pre><div class="admonition is-info" id="Initialisation-strategy-does-not-determine-log-Jacobian-7f2dbeac588181f"><header class="admonition-header">Initialisation strategy does not determine log-Jacobian<a class="admonition-anchor" href="#Initialisation-strategy-does-not-determine-log-Jacobian-7f2dbeac588181f" title="Permalink"></a></header><div class="admonition-body"><p>In the above examples, we used <code>InitFromParams</code> to provide variable values. <code>InitFromParams</code> is an <a href="../init/">initialisation strategy</a> and when given a VarNamedTuple of values as we did above, it always interprets those values as being in untransformed space.</p><p>This does not however mean that the log-Jacobian is disregarded! As we see in the second example above, when using <code>LinkAll()</code>, the log-Jacobian is still applied even though the values were provided in untransformed space. The <em>transform strategy</em> is what determines whether the log-Jacobian is applied or not when evaluating the log-probability. One could think of the transform strategy as being a <em>re-interpretation</em> of the value provided by the initialisation strategy.</p><p>This frees up the initialisation strategy to return whatever kind of <code>AbstractTransformedValue</code> is most convenient for it.</p></div></div><h2 id="Making-your-own-transform-strategy"><a class="docs-heading-anchor" href="#Making-your-own-transform-strategy">Making your own transform strategy</a><a id="Making-your-own-transform-strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Making-your-own-transform-strategy" title="Permalink"></a></h2><p>The only requirement for a subtype of an <code>AbstractTransformStrategy</code> is that it must implement <a href="../api/#DynamicPPL.target_transform"><code>target_transform(::AbstractTransformStrategy, vn::VarName)</code></a>, where <code>vn</code> is the variable on the left-hand side of a tilde-statement.</p><p><code>target_transform</code> must in turn return an <a href="../api/#DynamicPPL.AbstractTransform"><code>AbstractTransform</code></a> specifying whether the variable should be transformed or not.</p><p>For example, the following would cause <code>x</code> to be transformed but not <code>y</code>.</p><pre><code class="language-julia hljs">struct LookupTransformsInVNT{V&lt;:VarNamedTuple} &lt;: AbstractTransformStrategy
    transforms::V
end

function DynamicPPL.target_transform(l::LookupTransformsInVNT, vn::VarName)
    return l.transforms[vn]
end

link_x_only = LookupTransformsInVNT(@vnt begin
    x := DynamicLink()
    y := Unlink()
end)

_, vi_link_x_only = init!!(f(), OnlyAccsVarInfo(), InitFromParams(params), link_x_only)
vi_link_x_only.accs</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AccumulatorTuple with 3 accumulators
├─ <span class="sgr36">LogPrior</span> =&gt; LogPriorAccumulator(-3.2589168389831387)
├─ <span class="sgr36">LogJacobian</span> =&gt; LogJacobianAccumulator(-0.4054651081081644)
└─ <span class="sgr36">LogLikelihood</span> =&gt; LogLikelihoodAccumulator(0.0)</code></pre><h2 id="DynamicLink-in-more-detail"><a class="docs-heading-anchor" href="#DynamicLink-in-more-detail"><code>DynamicLink</code> in more detail</a><a id="DynamicLink-in-more-detail-1"></a><a class="docs-heading-anchor-permalink" href="#DynamicLink-in-more-detail" title="Permalink"></a></h2><p>Looking at the two transform types used above, <code>Unlink()</code> is probably more intuitive: it just means &#39;do not interpret this variable as being in transformed space&#39;. However, <code>DynamicLink()</code> is a bit more subtle.</p><p>In particular, for <code>DynamicLink()</code>, the actual transformation used is obtained at runtime from the distribution on the right-hand side of the tilde-statement, using:</p><pre><code class="language-julia hljs">DynamicPPL.from_linked_vec_transform(LogNormal())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DynamicPPL.UnwrapSingletonTransform{Tuple{}}(()) ∘ (Base.Fix1{typeof(broadcast), typeof(exp)}(broadcast, exp) ∘ DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}((1,), ()))</code></pre><p>(which ultimately calls functions from Bijectors.jl). This means that the transformation is recalculated on every model evaluation.</p><p>One might question why this is necessary: for example, in this simple model, we know that <code>x</code> and <code>y</code> are always <code>LogNormal</code>, so why not just store use the log-transform directly?</p><p>The answer is to do with distributions whose support (and hence transformation) can vary. For example, consider:</p><pre><code class="language-julia hljs">@model function g()
    x ~ Normal()
    return y ~ truncated(Normal(); lower=x)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">g (generic function with 2 methods)</code></pre><p>In this example, the support of <code>y</code> depends on what value <code>x</code> takes, and that can vary from one evaluation to the next. Consequently, the transformation used for <code>y</code> must be determined at runtime; if we cache a fixed transformation, it is possible that this transformation will be invalid (e.g. by mapping unconstrained values to values outside the support of <code>y</code>).</p><p>For correctness, DynamicPPL therefore always prefers to determine the transformation at runtime when using <code>DynamicLink()</code>. This behaviour is encoded in (for example) Turing&#39;s HMC samplers, which use <code>LinkAll()</code> as the default transform strategy, and hence every <code>VarName</code> will have a <code>target_transform</code> of <code>DynamicLink()</code>.</p><h2 id="Fixed-transformations"><a class="docs-heading-anchor" href="#Fixed-transformations">Fixed transformations</a><a id="Fixed-transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed-transformations" title="Permalink"></a></h2><p>For some models, it may be known that the support of a variable does not change, and that the transformations should be fixed. This allows us to avoid the overhead of recomputing the transformation at every model evaluation.</p><p>This is currently not implemented, but there is a plan for it; see <a href="https://github.com/TuringLang/DynamicPPL.jl/issues/1249">this DynamicPPL issue</a> for details.</p><h2 id="Why-not-let-init()-determine-the-transform?"><a class="docs-heading-anchor" href="#Why-not-let-init()-determine-the-transform?">Why not let <code>init()</code> determine the transform?</a><a id="Why-not-let-init()-determine-the-transform?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-not-let-init()-determine-the-transform?" title="Permalink"></a></h2><div class="admonition is-warning" id="Warning-6716d026bdd43e9a"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-6716d026bdd43e9a" title="Permalink"></a></header><div class="admonition-body"><p>This section is mainly for developers and advanced users interested in the design decisions behind DynamicPPL; it has no real implications for everyday usage.</p></div></div><p>An alternative to having an explicit link strategy would be to simply allow the initialisation strategy to determine whether variables are transformed or not. In this world, if <code>init(rng, vn, dist, strategy)</code> returned a transformed value, then we could treat it as being in transformed space, and vice versa.</p><p>The reason why we do this is to allow more flexibility in how models are evaluated, which can in turn save us from having to rerun the model multiple times.</p><p>Consider, for example, <code>DynamicPPL.InitFromUniform</code>. This is an initialisation strategy which samples uniformly from <code>[-2, 2]</code> in transformed space, and is used by Turing&#39;s HMC samplers to generate initial values. This used to be a standard workflow in Turing:</p><pre><code class="language-julia hljs">using Random
_, vi = init!!(Xoshiro(468), f(), VarInfo(), InitFromUniform())

# We&#39;ll run this later.
# vi_linked = link!!(vi, f())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">((0.1584005226486094, 0.18462758115248692), VarInfo{UnlinkAll, VarNamedTuple{(:x, :y), Tuple{VectorValue{Vector{Float64}, DynamicPPL.UnwrapSingletonTransform{Tuple{Int64}}}, VectorValue{Vector{Float64}, DynamicPPL.UnwrapSingletonTransform{Tuple{Int64}}}}}, DynamicPPL.AccumulatorTuple{3, @NamedTuple{LogPrior::LogPriorAccumulator{Float64}, LogJacobian::LogJacobianAccumulator{Float64}, LogLikelihood::LogLikelihoodAccumulator{Float64}}}}(UnlinkAll(), VarNamedTuple(x = VectorValue{Vector{Float64}, DynamicPPL.UnwrapSingletonTransform{Tuple{Int64}}}([0.1584005226486094], DynamicPPL.UnwrapSingletonTransform{Tuple{Int64}}((1,))), y = VectorValue{Vector{Float64}, DynamicPPL.UnwrapSingletonTransform{Tuple{Int64}}}([0.18462758115248692], DynamicPPL.UnwrapSingletonTransform{Tuple{Int64}}((1,)))), DynamicPPL.AccumulatorTuple{3, @NamedTuple{LogPrior::LogPriorAccumulator{Float64}, LogJacobian::LogJacobianAccumulator{Float64}, LogLikelihood::LogLikelihoodAccumulator{Float64}}}((LogPrior = LogPriorAccumulator(-1.4305346771581844), LogJacobian = LogJacobianAccumulator(0.0), LogLikelihood = LogLikelihoodAccumulator(0.0)))))</code></pre><p>In the first line, we are populating an empty <code>VarInfo</code> with values. This initialisation always causes the <code>VarInfo</code> to be unlinked, because the behaviour of <code>init!!</code> on a <code>VarInfo</code> is to always retain the transform state of the <code>VarInfo</code> (which is empty at this point, and hence unlinked).</p><p>If we did not have a separate transform strategy, then we would have to make sure that <code>init()</code> always returned <em>untransformed</em> values when using <code>InitFromUniform</code> (otherwise we would be filling the <code>VarInfo</code> with transformed values, which is not what we want here). So we have this extra step where <code>InitFromUniform</code> has to generate transformed values, untransform them, and then pass them on to the <code>VarInfo</code> so that it can store untransformed values. (This was indeed <a href="https://github.com/TuringLang/DynamicPPL.jl/blob/eea8d01c5fb217c1a0f4df170bf1ca16ee879c10/src/contexts/init.jl#L108-L119">the way <code>InitFromUniform</code> was implemented in DynamicPPL &lt;= v0.39</a>).</p><p>If we then wanted to link the VarInfo again</p><pre><code class="language-julia hljs">vi_linked = link!!(vi, f())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">VarInfo</span>
 ├─ <span class="sgr1">transform_strategy: </span>LinkAll()
 ├─ <span class="sgr1">values</span>
 │  VarNamedTuple
 │  ├─ <span class="sgr36">x</span> =&gt; LinkedVectorValue{Vector{Float64}, ComposedFunction{DynamicPPL.UnwrapSingletonTransform{Tuple{}}, ComposedFunction{Base.Fix1{typeof(broadcast), typeof(exp)}, DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}}}}([-1.8426285000579532], DynamicPPL.UnwrapSingletonTransform{Tuple{}}(()) ∘ (Base.Fix1{typeof(broadcast), typeof(exp)}(broadcast, exp) ∘ DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}((1,), ())))
 │  └─ <span class="sgr36">y</span> =&gt; LinkedVectorValue{Vector{Float64}, ComposedFunction{DynamicPPL.UnwrapSingletonTransform{Tuple{}}, ComposedFunction{Base.Fix1{typeof(broadcast), typeof(exp)}, DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}}}}([-1.689414557713834], DynamicPPL.UnwrapSingletonTransform{Tuple{}}(()) ∘ (Base.Fix1{typeof(broadcast), typeof(exp)}(broadcast, exp) ∘ DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}((1,), ())))
 └─ <span class="sgr1">accs</span>
    AccumulatorTuple with 3 accumulators
    ├─ <span class="sgr36">LogPrior</span> =&gt; LogPriorAccumulator(-1.4305346771581844)
    ├─ <span class="sgr36">LogJacobian</span> =&gt; LogJacobianAccumulator(3.532043057771787)
    └─ <span class="sgr36">LogLikelihood</span> =&gt; LogLikelihoodAccumulator(0.0)</code></pre><p>then we would have to recompute the forward transform, which frustratingly enough is exactly the same as what <code>InitFromUniform</code> had to <em>undo</em>. So we are calculating the same transformation twice, and evaluating the model twice, to make sure that our <code>VarInfo</code> ends up in the right state.</p><p>Instead, now with a separate transform strategy, we can immediately do:</p><pre><code class="language-julia hljs">_, vi_linked = init!!(Xoshiro(468), f(), VarInfo(), InitFromUniform(), LinkAll())
vi_linked</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">VarInfo</span>
 ├─ <span class="sgr1">transform_strategy: </span>LinkAll()
 ├─ <span class="sgr1">values</span>
 │  VarNamedTuple
 │  ├─ <span class="sgr36">x</span> =&gt; LinkedVectorValue{Vector{Float64}, ComposedFunction{DynamicPPL.UnwrapSingletonTransform{Tuple{}}, ComposedFunction{Base.Fix1{typeof(broadcast), typeof(exp)}, DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}}}}([-1.8426285000579532], DynamicPPL.UnwrapSingletonTransform{Tuple{}}(()) ∘ (Base.Fix1{typeof(broadcast), typeof(exp)}(broadcast, exp) ∘ DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}((1,), ())))
 │  └─ <span class="sgr36">y</span> =&gt; LinkedVectorValue{Vector{Float64}, ComposedFunction{DynamicPPL.UnwrapSingletonTransform{Tuple{}}, ComposedFunction{Base.Fix1{typeof(broadcast), typeof(exp)}, DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}}}}([-1.689414557713834], DynamicPPL.UnwrapSingletonTransform{Tuple{}}(()) ∘ (Base.Fix1{typeof(broadcast), typeof(exp)}(broadcast, exp) ∘ DynamicPPL.ReshapeTransform{Tuple{Int64}, Tuple{}}((1,), ())))
 └─ <span class="sgr1">accs</span>
    AccumulatorTuple with 3 accumulators
    ├─ <span class="sgr36">LogPrior</span> =&gt; LogPriorAccumulator(-1.4305346771581844)
    ├─ <span class="sgr36">LogJacobian</span> =&gt; LogJacobianAccumulator(3.532043057771787)
    └─ <span class="sgr36">LogLikelihood</span> =&gt; LogLikelihoodAccumulator(0.0)</code></pre><p>We can see that we have gotten exactly the same result, but with only running the model once, and only calculating the transformation once. Furthermore, this allows us to remove the inverse transform step inside <code>InitFromUniform</code>: it can simply return a <code>LinkedVectorValue</code> directly, and the transform strategy is then responsible for performing the inverse transform a single time.</p><p>Essentially, having a separate transform strategy allows us to:</p><ol><li><p>Free up the initialisation strategy to return whatever kind of <code>AbstractTransformedValue</code> is most convenient for it, without worrying about whether it needs to perform some transform.</p></li><li><p>Consolidate all the actual transformation in a single function (<code>DynamicPPL.apply_transform_strategy</code>), which allows us to ensure that each tilde-statement involves at most <em>one</em> transformation.</p></li></ol><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../init/">« Initialisation strategies</a><a class="docs-footer-nextpage" href="../accs/overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Wednesday 25 February 2026 00:31">Wednesday 25 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
